namespace = aihealthcheck

event = {
	id = aihealthcheck.1
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		
		### Machine Empires
		every_country = {
			limit = {
				is_ai = yes
				is_machine_empire = yes
				not = { is_country_type = primitive }
				not = { is_country_type = fallen_empire }
				not = { is_country_type = awakened_fallen_empire }
				not = { is_country_type = enclave }
				not = { is_country_type = nomad }
				not = { is_country_type = dormant_marauders }
				not = { is_country_type = awakened_marauders }
			}
			random_owned_planet = {
				limit = {
					is_colony = yes
					count_owned_pop = { count >= 5 }
					not = { has_planet_flag = pf_health_checked }
				}
				set_timed_planet_flag = {
					flag = pf_health_checked
					days = 90
				}
				add_modifier = {
					modifier = health_checking
					days = 90
				}
				
				log = "ME: Check for planet [This.GetName]"
				# Housing shortage - Nexus possible
				if = {
					limit = {
						free_housing < 1
						not = { uses_district_set = ring_world } 
						num_free_districts = { type = district_nexus value > 1 }
						
					}
					add_district = district_nexus
					log = "ME: Adding Nexus on [This.GetName]"
					add_modifier = { modifier = hc_city_added days = 360 }										
				}
				if = {
					limit = {
						free_housing < 1
						uses_district_set = ring_world
						num_free_districts = { type = district_rw_nexus value > 1 }
						
					}
					add_district = district_rw_nexus
					log = "ME: Adding RW Nexus on [This.GetName]"					
					add_modifier = { modifier = hc_city_added days = 360 }										
				}
				
				# Early minerals crisis
				if = {
					limit = {
						free_jobs > 1
						owner = { has_monthly_income = { resource = minerals value < -5 }}
						owner = { has_monthly_income = { resource = alloys value > 10 }}						
						num_buildings = { type = building_foundry_1 value > 1 }
					}
					log = "ME: Removing Foundry on [This.GetName]"					
					remove_building = building_foundry_1
				}

				# Calvitix Zone Commerc Vs Foundry
				if = {
					limit = {
						free_jobs > 1
						free_amenities > 20
						owner = { has_monthly_income = { resource = alloys value < 20 }}						
						owner = { has_monthly_income = { resource = minerals value > 50 }}						
						num_free_districts = { type = district_industrial value > 0 }
					}
					#remove_building = building_commercial_zone
					add_district = district_industrial
					add_modifier = { modifier = hc_industrial_added days = 360 }										
					log = "ME: Adding District_industrial (vs Commerc. Zone) on [This.GetName]"					
										
				}


				
				# Early energy crisis
				if = {
					limit = {
						owner = { has_monthly_income = { resource = energy value < -20 }}
						#owner = { has_monthly_income = { resource = alloys value > 20 }}						
						#has_building = building_foundry_1
						free_jobs < 5
					}					
					if = {
						limit = {
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator value > 0 }
						}
						add_district = district_generator
						log = "ME: Energy Crisis -20 : Adding district_generator on [This.GetName]"					
						
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					if = {
						limit = {
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_generator value > 0 }
						}
						add_district = district_rw_generator
						log = "ME: Energy Crisis -20 : Adding district_rw_generator on [This.GetName]"					
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}					
				}
				else_if = {
					limit = {
						free_jobs < 3
						owner = { has_monthly_income = { resource = energy value < 1 }}
						#owner = { has_monthly_income = { resource = consumer_goods value > 10 }}						
						#has_building = building_factory_1
					}
					if = {
						limit = {
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator value > 0 }
						}
						add_district = district_generator
						log = "ME: Energy Crisis <1 : Adding district_generator on [This.GetName]"					
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}
					else_if = {
						limit = {
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_generator value > 0 }
						}
						add_district = district_rw_generator
						log = "ME: Energy Crisis <1 : Adding district_rw_generator on [This.GetName]"					
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}					
				}
				
				# Housing shortage = building slot
				if = {
					limit = {
						free_housing < 1
						free_building_slots > 1
						num_free_districts = { type = district_nexus value < 2 }
					}
					add_building = building_drone_storage
					log = "ME: Housing Crisis <1 : Adding drone_storage on [This.GetName]"					
					add_modifier = { modifier = hc_building_added days = 360 }														
				}
				
				# Unemployment
				if = {
					limit = {
						or = {
							free_jobs < 10
							has_unemployed_workers = yes
						}
						owner = { has_monthly_income = { resource = energy value < 50 }}
					}
					if = {
						limit = {
							not = { uses_district_set = ring_world }						
							num_free_districts = { type = district_generator value > 0 }
						}
						add_district = district_generator
						log = "ME: Unemployement + Low Energy : Adding district_energy on [This.GetName]"					
						add_modifier = { modifier = hc_generator_added days = 360 }																
					}
					else_if = {
						limit = {
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_generator value > 0 }
						}
						add_district = district_rw_generator
						log = "ME: Unemployement + Low Energy : Adding district_energy on [This.GetName]"					
						add_modifier = { modifier = hc_generator_added days = 360 }
					}					
				}
				if = {
					limit = {
						or = {
							free_jobs < 5
							has_unemployed_specialists = yes
						}
						owner = { has_monthly_income = { resource = minerals value > 100 }}
						owner = { has_monthly_income = { resource = alloys value < 50 }}
					}
					if = {
						limit = {
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_industrial value > 0 }
						}
						add_district = district_industrial
						log = "ME: Unemployement + Good Miner. : Adding district_industrial on [This.GetName]"					
						add_modifier = { modifier = hc_industrial_added days = 360 }																
						
					}
					else_if = {
						limit = {
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_industrial value > 0 }
						}
						add_district = district_rw_industrial
						log = "ME: Unemployement + Good Miner. : Adding district_rw_industrial on [This.GetName]"					
						add_modifier = { modifier = hc_industrial_added days = 360 }																
					
					}
				}
				if = {
					limit = {
						or = {
							free_jobs < 5
							has_unemployed_workers = yes
						}
						owner = { has_monthly_income = { resource = energy value > 10 }}
					}
					if = {
						limit = {
							not = { uses_district_set = ring_world }
							owner = { has_monthly_income = { resource = minerals value < 100 }}
							num_free_districts = { type = district_mining value > 0 }
						}
						add_district = district_mining
						log = "ME: Unemployement + Low Miner. : Adding district_mining on [This.GetName]"					
						add_modifier = { modifier = hc_mining_added days = 360 }																
						
					}
				}
				if = {
					limit = {
						or = {					
							owner = { country_uses_food = yes }
							owner = { has_monthly_income = { resource = food value < -15 }}
						}
						or = {
							has_unemployed_workers = yes
							free_jobs < 4
							
						}
						owner = { has_monthly_income = { resource = food value < -1 }}
					}
					if = {
						limit = {
							owner = { has_monthly_income = { resource = food value < -1 }}
							num_free_districts = { type = district_farming value > 0 }
							not = { uses_district_set = ring_world }
						}
						add_district = district_farming
						log = "ME: Unemployement + Low food : Adding district_farming on [This.GetName]"					
						add_modifier = { modifier = hc_farming_added days = 360 }																
						
					}
					else_if = {
						limit = {
							num_free_districts = { type = district_rw_farming value > 0 }
							uses_district_set = ring_world
						}
						add_district = district_rw_farming
						log = "ME: Unemployement + Low food : Adding district_rw_farming on [This.GetName]"					
						add_modifier = { modifier = hc_farming_added days = 360 }																
						
					}					
				}
				if = {
					limit = {
						owner = { has_valid_civic = civic_machine_servitor }
						or = {
							free_jobs < 3
							has_unemployed_workers = yes
						}
						free_building_slots > 0
						owner = { has_monthly_income = { resource = minerals value > 50 }}
						owner = { has_monthly_income = { resource = consumer_goods value < 5 }}
					}
					add_building = building_factory_1
					log = "ME: Low goods : Adding building_factory_1 on [This.GetName]"					
					add_modifier = { modifier = hc_building_added days = 360 }														
				}
				if = {
					limit = {
						free_amenities < 5
						or = {
							free_jobs < 3
							has_unemployed_workers = yes
							}
						free_building_slots > 0
						not = { has_building = building_maintenance_depot }
					}
					add_building = building_maintenance_depot
					log = "ME: Unemployement + Low services : Adding maintenance_depot on [This.GetName]"					
					add_modifier = { modifier = hc_building_added days = 360 }														
				}
				if = {
					limit = {
						planet_crime > 10
						or = {
							has_unemployed_workers = yes
							free_jobs < 14
						}
						free_building_slots > 0
					}
					add_building = building_sentinel_posts
					log = "ME: High crime : Adding building_sentinel_posts on [This.GetName]"					
					add_modifier = { modifier = hc_building_added days = 360 }														
				}				
				if = {
					limit = {
						free_housing > 0
						or = {
							free_jobs < 2
							has_unemployed_specialists = yes
							}
						free_building_slots > 1
					}
					add_building = building_research_lab_1
					log = "ME: Unemployement + Research : Adding building_research_lab_1 on [This.GetName]"	
					add_modifier = { modifier = hc_building_added days = 360 }														
				}

				###Calvitix Ressource Exchange
				if = {
					limit = {
						owner = {
						has_resource = { type = minerals amount > 20000 }
						has_resource = { type = alloys amount < 5000 }
						}
					}
					owner = {
					log = "ME: Trade : -5000 minerals, +250 alloys on [This.GetName]"	
					add_resource = { alloys = 250 }
					add_resource = { minerals = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount > 20000 }
						has_resource = { type = energy amount < 5000 }
						}
					}
					owner = {
					log = "ME: Trade : -5000 food, +2500 energy on [This.GetName]"	
					add_resource = { energy = 2500 }
					add_resource = { food = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = consumer_goods amount > 15000 }
						has_resource = { type = energy amount < 5000 }
						}
					}
					owner = {
					log = "ME: Trade : -5000 goods, +5000 energy on [This.GetName]"	
					add_resource = { energy = 5000 }
					add_resource = { consumer_goods = -5000 }
					}
				}						
			}			
			#Calvitix SuperBonus (When I.A. no more ressource has)
			if = {
				limit = {
					owner = {
					has_resource = { type = energy amount < 500 }
					has_resource = { type = minerals amount < 200 }
					has_resource = { type = food amount < 200 }
					has_monthly_income = { resource = minerals value < 2 }
					has_monthly_income = { resource = energy value < 2 }
					has_monthly_income = { resource = food value < 2 }
					}
				}
				owner = {
					log = "ME: God Hand : Superbonus for [This.GetName]"	
					add_resource = { energy = 10000 }
					add_resource = { consumer_goods = 10000 }
					add_resource = { minerals = 10000 }
					add_resource = { food = 10000 }
					add_resource = { alloys = 1000 }
					#add_modifier = { modifier = hc_god_hand days = 600 }
				}
			}
		}
		### END Machine Empires
		
		### Regular Empires
		every_country = {
			limit = {
				is_ai = yes
				is_regular_empire = yes
				not = { is_country_type = primitive }
				not = { is_country_type = fallen_empire }
				not = { is_country_type = awakened_fallen_empire }
				not = { is_country_type = enclave }
				not = { is_country_type = nomad }
				not = { is_country_type = dormant_marauders }
				not = { is_country_type = awakened_marauders }
			}
			random_owned_planet = {
				limit = {
					is_colony = yes
					num_pops > 4
					not = { has_planet_flag = pf_health_checked }
				}
				log = "E: Check for planet [This.GetName]"

				random_list = {
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 270
						}
						add_modifier = {
							modifier = health_checking
							days = 270
						}
					}
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 360
						}
						add_modifier = {
							modifier = health_checking
							days = 360
						}
					}
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 180
						}
						add_modifier = {
							modifier = health_checking
							days = 180
						}
					}
					10 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 90
						}
						add_modifier = {
							modifier = health_checking
							days = 90
						}
					}
				}
				
				# Early energy crisis
				if = {
					limit = {
						owner = { has_monthly_income = { resource = energy value < -20 }}
						#owner = { has_monthly_income = { resource = alloys value > 20 }}						
						#has_building = building_foundry_1
						free_jobs < 5
					}					
					if = {
						limit = {
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator value > 0 }
						}
						add_district = district_generator
						log = "E : Energy Crisis -20 : adding district_generator for [This.GetName]"	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					if = {
						limit = {
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_generator value > 0 }
						}
						add_district = district_rw_generator
						log = "E : Energy Crisis -20 : adding district_rw_generator for [This.GetName]"	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}					
				}
				if = {
					limit = {
						free_jobs < 5
						owner = { has_monthly_income = { resource = energy value < 1 }}
						#owner = { has_monthly_income = { resource = consumer_goods value > 10 }}						
						#has_building = building_factory_1
					}
					if = {
						limit = {
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator value > 0 }
						}
						add_district = district_generator
						log = "E : Energy Crisis < 1 : adding district_generator for [This.GetName]"	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}
					else_if = {
						limit = {
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_generator value > 0 }
						}
						add_district = district_rw_generator
						log = "E : Energy Crisis < 1 : adding district_rw_generator for [This.GetName]"	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}					
				}


				# Early minerals crisis
				# Make artisans and metallurgists into miners
				if = {
					limit = {
						free_jobs < 5						
						owner = { has_monthly_income = { resource = minerals value < -5 }}
						owner = { has_monthly_income = { resource = alloys value > 10 }}						
						num_districts = { type = district_industrial value > 1 }
					}
					if = {
						limit = {
							num_free_districts = { type = district_mining value > 0 }
						}
						add_district = district_mining
						log = "E : Minerals Crisis < -5 : adding district_mining, delete district_industrial for [This.GetName]"	
						add_modifier = { modifier = hc_mining_added days = 360 }
						remove_district = district_industrial
					}
				}
				if = {
					limit = {
						free_jobs < 5
						owner = { has_monthly_income = { resource = minerals value < -20 }}
						#has_building = building_factory_1
					}
					if = {
						limit = {
							owner = { has_monthly_income = { resource = minerals value < -20 }}
							num_free_districts = { type = district_mining value > 0 }
						}
						add_district = district_mining
						log = "E : Minerals Crisis < -20 : adding district_mining for [This.GetName]"	
						add_modifier = { modifier = hc_mining_added days = 360 }																
						#remove_building = building_factory_1
					}
				}
				
				# Early CGs crisis
				# Make researchers into artisans
				if = {
					limit = {
						owner = { has_monthly_income = { resource = alloys value < 0 }}
						owner = { has_monthly_income = { resource = minerals value > 50 }}
						has_building = building_research_lab_1
						num_free_districts = { type = district_industrial value > 0 }		
					}
					remove_building = building_research_lab_1
					log = "E : alloy Crisis < -20 : adding district_industrial, removing research_lab for [This.GetName]"	
					add_district = district_industrial
					add_modifier = { modifier = hc_industrial_added days = 360 }																
					
				}
				
				# Calvitix Zone Commerc Vs Foundry
				if = {
					limit = {
						free_jobs > 1
						free_amenities > 20
						owner = { has_monthly_income = { resource = alloys value < -20 }}						
						owner = { has_monthly_income = { resource = minerals value > 50 }}
						owner = { has_monthly_income = { resource = energy value > 50 }}
						num_buildings = { type = building_commercial_zone value > 1 }
						num_free_districts = { type = district_industrial value > 0 }								
					}
					remove_building = building_commercial_zone
					add_district = district_industrial
					log = "E : alloy Crisis < -20 : adding district_industrial, removing commercial for [This.GetName]"	
					add_modifier = { modifier = hc_industrial_added days = 360 }																
					
				}

				# Crime and Instability
				if = {
					limit = {
						or = {
							planet_crime > 20
							and = {
								planet_crime > 10
								planet_stability < 50
							}
						}
						not = { has_building = building_precinct_house }
						not = { has_building = building_hall_judgment }
					}
					if = {
						limit = { 
							free_building_slots > 0
							free_jobs < 1
						}
						add_building = building_precinct_house
						log = "E : High Crime > 20 : adding building_precinct_house for [This.GetName]"	
						add_modifier = { modifier = hc_building_added days = 360 }														
					}
					else_if = {
						limit = { has_building = building_holo_theatres }
						remove_building = building_holo_theatres
						add_building = building_precinct_house
						log = "E : High Crime > 20 : adding building_precinct_house, removing building_holo_theatres for [This.GetName]"	
						add_modifier = { modifier = hc_building_added days = 360 }														
					}
					else_if = {
						limit = { has_building = building_research_lab_1 }
						remove_building = building_research_lab_1
						add_building = building_precinct_house
						log = "E : High Crime > 20 : adding building_precinct_house, removing building_research_lab_1 for [This.GetName]"	
						add_modifier = { modifier = hc_building_added days = 360 }														
					}
					else_if = {
						limit = { 
							#num_buildings = { type = building_foundry_1 value > 1 }
							free_building_slots > 0
							#owner = { has_monthly_income = { resource = alloys value > 20 }}													
						}
						#remove_building = building_foundry_1
						add_building = building_precinct_house
						log = "E : High Crime > 20 : adding building_precinct_house for [This.GetName]"	
						add_modifier = { modifier = hc_building_added days = 360 }														
					}					
				}
				
				# Amenities
				if = {
					limit = {
						or = {
							free_amenities < 1
							and = {
								free_amenities < 5
								planet_stability < 25
							}
						}
						not = { has_building = building_holo_theatres }
						not = { has_building = building_hyper_entertainment_forum }
					}
					if = {
						limit = { 
							free_building_slots > 0
							free_jobs < 1
						}
						add_building = building_holo_theatres
						log = "E : Low Services < 5 : adding building_holo_theatres for [This.GetName]"	
						add_modifier = { modifier = hc_building_added days = 360 }														
					}
					else_if = {
						limit = { has_building = building_research_lab_1 }
						remove_building = building_research_lab_1
						add_building = building_holo_theatres						
						log = "E : Low Services < 5 : adding building_holo_theatres, removing building_research_lab_1 for [This.GetName]"	
						add_modifier = { modifier = hc_building_added days = 360 }														
					}
					else_if = {
						limit = { 
							free_building_slots > 0
							#num_buildings = { type = building_foundry_1 value > 2 }
							#owner = { has_monthly_income = { resource = alloys value > 15 }}
						}
						#remove_building = building_foundry_1
						add_building = building_holo_theatres
						log = "E : Low Services < 5 : adding building_holo_theatres for [This.GetName]"	
						add_modifier = { modifier = hc_building_added days = 360 }														
					}					
				}
				
				# Create More Jobs
				if = {
					limit = {
						or = {
							and = {
								free_jobs < 2
								free_building_slots > 1
							}
							and = {
								free_jobs < 3
								free_building_slots > 2
							}
							and = {
								free_jobs < 4
								free_district_slots > 2
							}
							and = {
								free_jobs < 2
								free_district_slots > 1
							}
							and = {
								num_pops > 40
								free_jobs < 1
								free_district_slots < 3
								free_building_slots > 0
								has_building_construction = no
							}
							and = {
								num_pops > 50
								free_jobs < 1
								free_district_slots < 1
								free_building_slots > 0
								has_building_construction = no
							}
						}
					}
					if = {
						limit = {
							num_free_districts = { type = district_industrial value > 0 }
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							owner = { has_monthly_income = { resource = alloys value < 20 }}
						}
						add_district = district_industrial
						log = "E : Enough room : adding district_industrial for [This.GetName]"	
						add_modifier = { modifier = hc_industrial_added days = 360 }																
						
					}
					else_if = {
						limit = {
							num_free_districts = { type = district_industrial value > 0 }
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							owner = { has_monthly_income = { resource = consumer_goods value < 20 }}
						}
						add_district = district_industrial					
						log = "E : Enough room : adding district_industrial for [This.GetName]"	
						add_modifier = { modifier = hc_industrial_added days = 360 }																
					}
					else_if = {
						limit = {
							not = { has_building = building_research_lab_1 }
							free_building_slots > 1
						}
						add_building = building_research_lab_1					
						log = "E : Enough room : adding building_research_lab_1 for [This.GetName]"	
						add_modifier = { modifier = hc_building_added days = 360 }														
					}
					else_if = {
						limit = {
							not = { has_building = building_holo_theatres }
							free_building_slots > 0
						}
						add_building = building_holo_theatres				
						log = "E : Enough room : adding building_holo_theatres for [This.GetName]"	
						add_modifier = { modifier = hc_building_added days = 360 }														
					}
					else_if = {
						limit = {
							num_buildings = { type = building_research_lab_1 value < 4 }
							free_building_slots > 0
						}
						add_building = building_research_lab_1					
						log = "E : Enough room : adding building_research_lab_1 for [This.GetName]"	
						add_modifier = { modifier = hc_building_added days = 360 }														
					}
					else_if = {
						limit = {
							free_building_slots > 0
						}
						add_building = building_commercial_zone
						log = "E : Enough room : adding building_commercial_zone for [This.GetName]"	
						add_modifier = { modifier = hc_building_added days = 360 }														
					}
				}
				
				# Unemployment
				if = {
					limit = { any_owned_pop = { is_unemployed = yes }}
					if = {
						limit = { 
							owner = { has_monthly_income = { resource = energy value < 50 }}
						}
						if = {
							limit = {
								not = { uses_district_set = ring_world }
								num_free_districts = { type = district_generator value > 0 }
							}
							add_district = district_generator
						log = "E : Unemploiyment & low Energy : adding district_generator for [This.GetName]"	
							add_modifier = { modifier = hc_generator_added days = 360 }																
						}
						else_if = {
							limit = {
								uses_district_set = ring_world
								num_free_districts = { type = district_rw_generator value > 0 }
							}
							add_district = district_rw_generator
							log = "E : Unemploiyment & low Energy : adding district_rw_generator for [This.GetName]"	
							add_modifier = { modifier = hc_generator_added days = 360 }																							
						}												
					}
					else_if = {
						limit = {
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							owner = { has_monthly_income = { resource = alloys value < 20 }}
						}
						if = {
							limit = {
								not = { uses_district_set = ring_world }
								num_free_districts = { type = district_industrial value > 0 }
							}
							add_district = district_industrial
							log = "E : Unemployment & low alloy : adding district_industrial for [This.GetName]"	
							add_modifier = { modifier = hc_industrial_added days = 360 }																
						}
						else_if = {
							limit = {
								uses_district_set = ring_world
								num_free_districts = { type = district_rw_industrial value > 0 }
							}
							add_district = district_rw_industrial
							log = "E : Unemployment & low alloy : adding district_rw_industrial for [This.GetName]"	
							add_modifier = { modifier = hc_industrial_added days = 360 }																
							
						}
					}					
					if = {
						limit = { 
							owner = { has_monthly_income = { resource = food value < 0 }}
						}
						if = {
							limit = {
								not = { uses_district_set = ring_world }
								num_free_districts = { type = district_farming value > 0 }
							}
							add_district = district_farming
							log = "E : Unemployment & low food : adding district_farming for [This.GetName]"	
							add_modifier = { modifier = hc_farming_added days = 360 }																
						}
						else_if = {
							limit = {
								uses_district_set = ring_world
								num_free_districts = { type = district_rw_farming value > 0 }
							}
							add_district = district_rw_farming
							log = "E : Unemployment & low food : adding district_farming for [This.GetName]"	
							add_modifier = { modifier = hc_farming_added days = 360 }																
						}					
					}
					if = {
						limit = { 
							owner = { has_monthly_income = { resource = minerals value < 0 }}
						}
						if = {
							limit = {
								not = { uses_district_set = ring_world }
								num_free_districts = { type = district_mining value > 0 }
							}
							add_district = district_mining
							add_modifier = { modifier = hc_mining_added days = 360 }																
						}
						else_if = {
							limit = {
								not = { uses_district_set = ring_world }
								num_free_districts = { type = district_rw_mining value > 0 }
							}
							add_district = district_rw_mining
							add_modifier = { modifier = hc_mining_added days = 360 }																
						}
					}
					else_if = {
						limit = {
							#num_buildings = { type = building_foundry_1 value < 5 }
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							owner = { has_monthly_income = { resource = alloys value < 20 }}
							num_free_districts = { type = district_industrial value > 0 }								
						}
						add_district = district_industrial
						add_modifier = { modifier = hc_industrial_added days = 360 }																
					}
					else_if = {
						limit = { 
							#num_buildings = { type = building_factory_1 value < 4 }
							owner = { has_monthly_income = { resource = consumer_goods value < 20 }}
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							num_free_districts = { type = district_industrial value > 0 }
							
						}
						add_district = district_industrial
						add_modifier = { modifier = hc_industrial_added days = 360 }																
					}
					else_if = {
						limit = { free_building_slots > 1 }
						if = {
							limit = { num_buildings = { type = building_research_lab_1 value < 4 } }
							add_building = building_research_lab_1					
							add_modifier = { modifier = hc_building_added days = 360 }														
						}
						else_if = {
							limit = {
								not = { has_building = building_holo_theatres }
								free_amenities < 10
							}
							add_building = building_holo_theatres				
							add_modifier = { modifier = hc_building_added days = 360 }														
						}
						else = { 
							add_building = building_commercial_zone
							add_modifier = { modifier = hc_building_added days = 360 }														
						}
					}					
				}
				
				
				# Uncleared blockers - just get rid of them
				if = {
					limit = { free_district_slots < 2 }
					clear_blockers = yes
				}
				
				# Economic Fine Tuning - surplus is wasting space
				if = {
					limit = {
						free_housing > 4
						free_jobs > 3
						free_district_slots < 5
						not = { any_owned_pop = { is_unemployed = yes }}
					}
					if = {
						limit = {
							has_district = district_farming
							owner = {
								has_monthly_income = {
									resource = food
									value > 150
								}
								resource_stockpile_compare = {
									resource = food
									value > 5000
								}
							}
						}
						remove_district = district_farming
					}
				}
				if = {
					limit = {
						free_housing > 3
						free_jobs > 3
						free_district_slots < 2
						not = { any_owned_pop = { is_unemployed = yes }}
					}
					if = {
						limit = {
							has_district = district_mining
							owner = {
								has_monthly_income = {
									resource = minerals
									value > 500
								}
								resource_stockpile_compare = {
									resource = minerals
									value > 12000
								}
							}
						}
						remove_district = district_mining
					}
				}
				if = {
					limit = {
						free_housing > 3
						free_jobs > 3
						free_district_slots < 2
						not = { any_owned_pop = { is_unemployed = yes }}
					}
					if = {
						limit = {
							has_district = district_generator
							owner = {
								has_monthly_income = {
									resource = energy
									value > 250
								}
								resource_stockpile_compare = {
									resource = energy
									value > 10000
								}
							}
						}
						remove_district = district_generator
					}
				}
				
				# Housing
				if = {
					limit = {
						free_housing < 1
					}
					if = {
						limit = {
							not = { uses_district_set = ring_world }
							owner = { not = { has_origin = origin_gas_giant } }
							num_free_districts = { type = district_city value > 0 }
						}
						add_district = district_city
						add_modifier = { modifier = hc_city_added days = 360 }																
					}
					else_if = {
						limit = {
							not = { uses_district_set = ring_world }
							owner = { has_origin = origin_gas_giant }
							num_free_districts = { type = district_giga_planet_city value > 0 }
						}
						add_district = district_giga_planet_city
						add_modifier = { modifier = hc_city_added days = 360 }																
					}
					else_if = {
						limit = {
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_nexus value > 0 }
						}
						add_district = district_rw_nexus
						add_modifier = { modifier = hc_city_added days = 360 }																					
					}
					else_if = {
						limit = {
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_city value > 0 }
						}
						add_district = district_rw_city
						add_modifier = { modifier = hc_city_added days = 360 }																
					}
				}
				else_if = {
					limit = { free_housing < -1 }
					clear_blockers = yes
				}
				
				# Overcrowding - pointless unemployed homeless pops lags up the game
				if = {
					limit = {
						any_owned_pop = { is_unemployed = yes }
						free_building_slots < 1
						free_district_slots < 1
						num_pops > 82
						free_housing < 0
					}
					random_owned_pop = {
						limit = { is_unemployed = yes }
						kill_pop = yes
					}
					random_owned_pop = {
						limit = { is_unemployed = yes }
						kill_pop = yes
					}
					random_owned_pop = {
						limit = { is_unemployed = yes }
						kill_pop = yes
					}
				}
				
				# Surplus getting in the way
				if = {
					limit = {
						free_housing > 20
						num_districts = { type = district_city value > 0 }
						free_jobs > 2
					}
					remove_district = district_city
				}
				if = {
					limit = {
						has_building = building_commercial_zone
						free_jobs > 4
						free_amenities > 25
						owner = {
							has_monthly_income = {
								resource = energy
								value > 150
							}
							has_monthly_income = {
								resource = consumer_goods
								value > 75
							}
						}
					}
					remove_building = building_commercial_zone
				}
				
				# Shortages rectified by removing surplus
				# Make workers change jobs
				if = {
					limit = {
						num_districts = { type = district_mining value > 0 }
						num_free_districts = { type = district_farming value > 0 }
						owner = {
							has_monthly_income = { resource = minerals value > 80 }
							resource_stockpile_compare = { resource = minerals value > 1000 }
							has_monthly_income = { resource = food value < 2 }
						}
					}
					remove_district = district_mining
					add_district = district_farming
					add_modifier = { modifier = hc_farming_added days = 360 }																
					
				}						
				if = {
					limit = {
						has_district = district_generator
						num_free_districts = { type = district_farming value > 0 }
						owner = {
							has_monthly_income = {
								resource = energy
								value > 100
							}
							resource_stockpile_compare = {
								resource = energy
								value > 2000
							}
							has_monthly_income = {
								resource = food
								value < 2
							}
						}
					}
					remove_district = district_generator
					add_district = district_farming
					add_modifier = { modifier = hc_farming_added days = 360 }																					
				}
				if = {
					limit = {
						has_district = district_farming
						num_free_districts = { type = district_generator value > 0 }
						owner = {
							has_monthly_income = {
								resource = energy
								value < 2
							}
							resource_stockpile_compare = {
								resource = energy
								value < 500
							}
							has_monthly_income = {
								resource = food
								value > 50
							}
							resource_stockpile_compare = {
								resource = food
								value > 500
							}
						}
					}
					remove_district = district_farming
					add_district = district_generator
					add_modifier = { modifier = hc_generator_added days = 360 }																
					
				}
				
				# Minerals shortages are rare
				if = {
					limit = {
						free_jobs < 4
						num_pops > 25
						or = {
							owner = { has_monthly_income = { resource = minerals value < 1 }}
							and = {
								owner = { has_monthly_income = { resource = minerals value < 20 }}
								owner = { resource_stockpile_compare = { resource = minerals value < 1000 }}
							}
						}
					}
					if = {
						limit = {
							num_free_districts = { type = district_mining value > 0 }
						}
						add_district = district_mining
						add_modifier = { modifier = hc_mining_added days = 360 }																
						
					}
				}

				# Homeworld with too many empty building slots			
				if = {
					limit = {
						or = {
							is_homeworld = yes
							is_capital = yes
						}
						free_building_slots > 3
						free_jobs < 3
						num_pops > 40
					}
					add_building = building_research_lab_1
					add_modifier = { modifier = hc_building_added days = 360 }																
				}				
				if = {
					limit = {
						or = {
							is_homeworld = yes
							is_capital = yes
						}
						free_building_slots > 3
						free_jobs < 3
						num_pops > 45
					}
					add_building = building_research_lab_1
					add_modifier = { modifier = hc_building_added days = 360 }																
				}
				if = {
					limit = {
						or = {
							is_homeworld = yes
							is_capital = yes
						}
						free_building_slots > 2
						free_jobs < 3
						num_pops > 50
					}
					add_building = building_research_lab_1
					add_modifier = { modifier = hc_building_added days = 360 }																
				}				





				# Last resort
				if = {
					limit = {
						num_pops > 36
						free_building_slots > 0
						free_housing < 4
						owner = {
							or = {
								and = {
									has_monthly_income = {
										resource = food
										value < 0
									}
									resource_stockpile_compare = {
										resource = food
										value < 250
									}
								}
								and = {
									has_monthly_income = {
										resource = consumer_goods
										value < 0
									}
									resource_stockpile_compare = {
										resource = consumer_goods
										value < 250
									}
								}
							}
						}
					}
					random_owned_pop = {
						limit = {
							not = { has_job = technician }
							not = { has_job = miner }
							not = { has_job = farmer }
							not = { has_job = artisan }
						}
						kill_pop = yes
					}
				}
				
				###Calvitix Ressource Exchange
				if = {
					limit = {
						owner = {
						has_resource = { type = minerals amount > 20000 }
						has_resource = { type = alloys amount < 5000 }
						}
					}
					owner = {
					add_resource = { alloys = 250 }
					add_resource = { minerals = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount > 20000 }
						has_resource = { type = energy amount < 5000 }
						}
					}
					owner = {
					add_resource = { energy = 2500 }
					add_resource = { food = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = consumer_goods amount > 15000 }
						has_resource = { type = energy amount < 5000 }
						}
					}
					owner = {
					add_resource = { energy = 5000 }
					add_resource = { consumer_goods = -5000 }
					}
				}
			}	
			#Calvitix SuperBonus (When I.A. no more ressource has)
			if = {
				limit = {
					owner = {
					has_resource = { type = energy amount < 500 }
					has_resource = { type = minerals amount < 200 }
					has_resource = { type = food amount < 200 }
					has_monthly_income = { resource = minerals value < 2 }
					has_monthly_income = { resource = energy value < 2 }
					has_monthly_income = { resource = food value < 2 }
					}
				}
				owner = {
					add_resource = { energy = 10000 }
					add_resource = { consumer_goods = 10000 }
					add_resource = { minerals = 10000 }
					add_resource = { food = 10000 }
					add_resource = { alloys = 1000 }
					add_modifier = { modifier = hc_god_hand days = 600 }
				}
			}				
		}
		### Gestalt Empires
		every_country = {
			limit = {
				is_ai = yes
				is_regular_empire = no
				is_gestalt = yes
				not = { is_country_type = primitive }
				not = { is_country_type = fallen_empire }
				not = { is_country_type = awakened_fallen_empire }
				not = { is_country_type = enclave }
				not = { is_country_type = nomad }
				not = { is_country_type = dormant_marauders }
				not = { is_country_type = awakened_marauders }
			}
			random_owned_planet = {
				limit = {
					is_colony = yes
					num_pops > 4
					not = { has_planet_flag = pf_health_checked }
				}
				
				random_list = {
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 270
						}
						add_modifier = {
							modifier = health_checking
							days = 270
						}
					}
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 360
						}
						add_modifier = {
							modifier = health_checking
							days = 360
						}
					}
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 180
						}
						add_modifier = {
							modifier = health_checking
							days = 180
						}
					}
					10 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 90
						}
						add_modifier = {
							modifier = health_checking
							days = 90
						}
					}
				}
				
				# Early energy crisis
				if = {
					limit = {
						owner = { has_monthly_income = { resource = energy value < -20 }}
						#owner = { has_monthly_income = { resource = alloys value > 20 }}						
						#has_building = building_foundry_1
						free_jobs < 5
					}					
					if = {
						limit = {
							owner = { has_origin = origin_gas_giant }
							num_free_districts = { type = district_giga_planet_wind value > 0 }
						}
						add_district = district_giga_planet_wind
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					else_if = {
						limit = {
							owner = { has_origin = origin_gas_giant }
							num_free_districts = { type = district_giga_planet_solar value > 0 }
						}
						add_district = district_giga_planet_solar
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					else_if = {
						limit = {
							owner = { has_origin = origin_gas_giant }
							num_free_districts = { type = district_giga_planet_geothermal value > 0 }
						}
						add_district = district_giga_planet_geothermal
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					else_if = {
						limit = {
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator value > 0 }
						}
						add_district = district_generator
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					else_if = {
						limit = {
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_generator value > 0 }
						}
						add_district = district_rw_generator
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}					
				}
				if = {
					limit = {
						free_jobs < 5
						owner = { has_monthly_income = { resource = energy value < 1 }}
						#owner = { has_monthly_income = { resource = consumer_goods value > 10 }}						
						#has_building = building_factory_1
					}
					if = {
						limit = {
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator value > 0 }
						}
						add_district = district_generator
						#remove_building = building_factory_1
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}
					else_if = {
						limit = {
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_generator value > 0 }
						}
						add_district = district_rw_generator
						#remove_building = building_factory_1
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}					
				}


				# Early minerals crisis
				# Make artisans and metallurgists into miners
				if = {
					limit = {
						free_jobs < 5						
						owner = { has_monthly_income = { resource = minerals value < 1 }}
						owner = { has_monthly_income = { resource = alloys value > 10 }}						
						num_districts = { type = district_industrial value > 1 }
					}
					if = {
						limit = {
							num_free_districts = { type = district_mining value > 0 }
						}
						add_district = district_mining
						add_modifier = { modifier = hc_mining_added days = 360 }																
						remove_district = district_industrial
						#remove_building = building_foundry_1
					}
				}
				if = {
					limit = {
						free_jobs < 5
						owner = { has_monthly_income = { resource = minerals value < 1 }}
						owner = { has_monthly_income = { resource = consumer_goods value > 10 }}						
						has_building = building_factory_1
					}
					if = {
						limit = {
							num_free_districts = { type = district_mining value > 0 }
						}
						add_district = district_mining
						add_modifier = { modifier = hc_mining_added days = 360 }																
						remove_building = building_factory_1
					}
				}
				
				# Early CGs crisis
				# Make researchers into artisans
				if = {
					limit = {
						owner = { has_monthly_income = { resource = consumer_goods value < 0 }}
						owner = { has_monthly_income = { resource = minerals value > 50 }}
						#has_building = building_research_lab_1
						num_free_districts = { type = district_industrial value > 0 }

					}
					#remove_building = building_research_lab_1
					add_district = district_industrial
					add_modifier = { modifier = hc_industrial_added days = 360 }																
				}
				
				# Crime and Instability
				if = {
					limit = {
						or = {
							planet_crime > 20
							and = {
								planet_crime > 10
								planet_stability < 50
							}
						}
						not = { has_building = building_sentinel_posts }
					}
					if = {
						limit = { 
							free_building_slots > 0
							free_jobs < 1
						}
						add_building = building_sentinel_posts
						add_modifier = { modifier = hc_building_added days = 360 }																
					}
					else_if = {
						limit = { has_building = building_maintenance_depot }
						remove_building = building_maintenance_depot
						add_building = building_sentinel_posts
						add_modifier = { modifier = hc_building_added days = 360 }																
					}
					else_if = {
						limit = { has_building = building_research_lab_1 }
						remove_building = building_research_lab_1
						add_building = building_sentinel_posts
						add_modifier = { modifier = hc_building_added days = 360 }																
					}
					else_if = {
						limit = { 
							#has_building = building_foundry_1 
							free_building_slots > 0
							#owner = { has_monthly_income = { resource = alloys value > 10 }}													
						}
						#remove_building = building_foundry_1
						add_building = building_sentinel_posts
						add_modifier = { modifier = hc_building_added days = 360 }																
					}					
				}
				
				# Amenities
				if = {
					limit = {
						or = {
							free_amenities < 1
							and = {
								free_amenities < 5
								planet_stability < 25
							}
						}
						not = { has_building = building_maintenance_depot }						
					}
					if = {
						limit = { 
							free_building_slots > 0
							free_jobs < 1
						}
						add_building = building_maintenance_depot
						add_modifier = { modifier = hc_building_added days = 360 }																
					}
					else_if = {
						limit = { has_building = building_research_lab_1 }
						remove_building = building_research_lab_1
						add_building = building_maintenance_depot						
						add_modifier = { modifier = hc_building_added days = 360 }																
					}
					else_if = {
						limit = { 
							free_building_slots > 0
							#has_building = building_foundry_1 
							#owner = { has_monthly_income = { resource = alloys value > 10 }}													
						}
						#remove_building = building_foundry_1
						add_building = building_maintenance_depot
						add_modifier = { modifier = hc_building_added days = 360 }																
					}					
				}
				
				# Create More Jobs
				if = {
					limit = {
						or = {
							and = {
								free_jobs < 2
								free_building_slots > 1
							}
							and = {
								free_jobs < 3
								free_building_slots > 2
							}
							and = {
								num_pops > 40
								free_jobs < 1
								free_district_slots < 3
								free_building_slots > 0
								has_building_construction = no
							}
							and = {
								num_pops > 50
								free_jobs < 1
								free_district_slots < 1
								free_building_slots > 0
								has_building_construction = no
							}
						}
					}
					if = {
						limit = {
							not = { has_building = building_spawning_pool free_building_slots > 0 }
						}
						add_building = building_spawning_pool				
						add_modifier = { modifier = hc_building_added days = 360 }																
					}
					else_if = {
						limit = {
							#num_buildings = { type = building_foundry_1 value < 4 }
							num_free_districts = { type = district_industrial value > 0 }
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							owner = { has_monthly_income = { resource = alloys value < 20 }}
						}
						add_district = district_industrial
						add_modifier = { modifier = hc_industrial_added days = 360 }																
					}
					else_if = {
						limit = {
							num_free_districts = { type = district_industrial value > 0 }
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							owner = { has_monthly_income = { resource = consumer_goods value < 10 }}
						}
						add_district = district_industrial
						add_modifier = { modifier = hc_industrial_added days = 360 }																
					}
					else_if = {
						limit = {
							not = { has_building = building_research_lab_1 free_building_slots > 0 }
						}
						add_building = building_research_lab_1					
						add_modifier = { modifier = hc_building_added days = 360 }																
					}
					else_if = {
						limit = {
							not = { has_building = building_maintenance_depot free_building_slots > 0}
						}
						add_building = building_maintenance_depot				
						add_modifier = { modifier = hc_building_added days = 360 }																
					}
					else_if = {
						limit = { free_building_slots > 0 }
						add_building = building_spawning_pool
						add_modifier = { modifier = hc_building_added days = 360 }																
					}
				}
				
				# Unemployment
				if = {
					limit = { any_owned_pop = { is_unemployed = yes }}
					if = {
						limit = { 
							owner = { has_monthly_income = { resource = energy value < 50 }}
						}
						if = {
							limit = {
								num_free_districts = { type = district_generator value > 0 }
							}
							add_district = district_generator
							add_modifier = { modifier = hc_generator_added days = 360 }																
						}
						else_if = {
							limit = {
								num_free_districts = { type = district_rw_generator value > 0 }
							}
							add_district = district_rw_generator
							add_modifier = { modifier = hc_generator_added days = 360 }																
						}												
					}
					else_if = {
						limit = { 
							owner = { has_monthly_income = { resource = food value < 10 }}
						}
						if = {
							limit = {
								num_free_districts = { type = district_farming value > 0 }
							}
							add_district = district_farming
							add_modifier = { modifier = hc_farming_added days = 360 }																
						}
						else_if = {
							limit = {
								num_free_districts = { type = district_rw_farming value > 0 }
							}
							add_district = district_rw_farming
							add_modifier = { modifier = hc_farming_added days = 360 }																
							
						}					
					}
					else_if = {
						limit = { 
							owner = { has_monthly_income = { resource = minerals value < 75 }}
						}
						if = {
							limit = {
								num_free_districts = { type = district_mining value > 0 }
							}
							add_district = district_mining
							add_modifier = { modifier = hc_mining_added days = 360 }																
							
						}
					}
					else_if = {
						limit = { free_building_slots > 1 }
						if = {
							limit = {
								num_free_districts = { type = district_industrial value > 0 }
								owner = { has_monthly_income = { resource = minerals value > 50 }}
								owner = { has_monthly_income = { resource = alloys value < 20 }}
							}
							add_district = district_industrial
							add_modifier = { modifier = hc_industrial_added days = 360 }																
						}
						else_if = {
							limit = { 
								num_free_districts = { type = district_industrial value > 0 }
								owner = { has_monthly_income = { resource = consumer_goods value < 25 }}
							}
							add_district = district_industrial
							add_modifier = { modifier = hc_industrial_added days = 360 }																
						}
						else_if = {
							limit = { not = { has_building = building_research_lab_1 }}
							add_building = building_research_lab_1					
							add_modifier = { modifier = hc_building_added days = 360 }																
						}
						else_if = {
							limit = {
								num_buildings = { type = building_maintenance_depot value < 3 }
								free_amenities < 10
							}
							add_building = building_maintenance_depot				
							add_modifier = { modifier = hc_building_added days = 360 }																
						}
						else = { 
							add_building = building_spawning_pool
							add_modifier = { modifier = hc_building_added days = 360 }																
						}
					}
				}
				
				
				# Calvitix Zone Commerc Vs Foundry
				if = {
					limit = {
						free_jobs > 1
						#free_amenities > 20
						owner = { has_monthly_income = { resource = alloys value < 20 }}						
						owner = { has_monthly_income = { resource = minerals value > 50 }}						
						num_free_districts = { type = district_industrial value > 0 }
					}
					#remove_building = building_commercial_zone
					add_district = district_industrial
					add_modifier = { modifier = hc_industrial_added days = 360 }																
				}
				
				
				
				# Uncleared blockers - just get rid of them
				if = {
					limit = { free_district_slots < 2 }
					clear_blockers = yes
				}
				
				# Economic Fine Tuning - surplus is wasting space
				if = {
					limit = {
						free_housing > 4
						free_jobs > 3
						free_district_slots < 5
						not = { any_owned_pop = { is_unemployed = yes }}
					}
					if = {
						limit = {
							has_district = district_farming
							owner = {
								has_monthly_income = {
									resource = food
									value > 50
								}
								resource_stockpile_compare = {
									resource = food
									value > 5000
								}
							}
						}
						remove_district = district_farming
					}
				}
				if = {
					limit = {
						free_housing > 3
						free_jobs > 3
						free_district_slots < 2
						not = { any_owned_pop = { is_unemployed = yes }}
					}
					if = {
						limit = {
							has_district = district_mining
							owner = {
								has_monthly_income = {
									resource = minerals
									value > 500
								}
								resource_stockpile_compare = {
									resource = minerals
									value > 12000
								}
							}
						}
						remove_district = district_mining
					}
				}
				if = {
					limit = {
						free_housing > 3
						free_jobs > 3
						free_district_slots < 2
						not = { any_owned_pop = { is_unemployed = yes }}
					}
					if = {
						limit = {
							has_district = district_generator
							owner = {
								has_monthly_income = {
									resource = energy
									value > 250
								}
								resource_stockpile_compare = {
									resource = energy
									value > 10000
								}
							}
						}
						remove_district = district_generator
					}
				}
				
				# Housing
				if = {
					limit = {
						free_housing < 1
					}
					if = {
						limit = {
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_hive value > 0 }
						}
						add_district = district_hive
						add_modifier = { modifier = hc_city_added days = 360 }																
					}
					else_if = {
						limit = {
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_hive value > 0 }
						}
						add_district = district_rw_hive
						add_modifier = { modifier = hc_city_added days = 360 }																
					}
					else_if = {
						limit = {
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_nexus value > 0 }
						}
						add_district = district_rw_nexus
						add_modifier = { modifier = hc_city_added days = 360 }																
					}

				}
				else_if = {
					limit = { free_housing < -1 }
					clear_blockers = yes
				}
				
				# Overcrowding - pointless unemployed homeless pops lags up the game
				if = {
					limit = {
						any_owned_pop = { is_unemployed = yes }
						free_building_slots < 1
						free_district_slots < 1
						num_pops > 82
						free_housing < 0
					}
					random_owned_pop = {
						limit = { is_unemployed = yes }
						kill_pop = yes
					}
					random_owned_pop = {
						limit = { is_unemployed = yes }
						kill_pop = yes
					}
					random_owned_pop = {
						limit = { is_unemployed = yes }
						kill_pop = yes
					}
				}
				
				# Surplus getting in the way
				if = {
					limit = {
						free_housing > 20
						num_districts = { type = district_hive value > 0 }
						free_jobs > 2
					}
					remove_district = district_hive
				}
				if = {
					limit = {
						has_building = building_maintenance_depot
						free_jobs > 4
						free_amenities > 25
						owner = {
							has_monthly_income = {
								resource = energy
								value > 150
							}
							has_monthly_income = {
								resource = consumer_goods
								value > 75
							}
						}
					}
					remove_building = building_maintenance_depot
				}
				
				# Shortages rectified by removing surplus
				# Make workers change jobs
				if = {
					limit = {
						num_districts = { type = district_mining value > 0 }
						num_free_districts = { type = district_farming value > 0 }
						owner = {
							has_monthly_income = { resource = minerals value > 80 }
							resource_stockpile_compare = { resource = minerals value > 1000 }
							has_monthly_income = { resource = food value < 2 }
						}
					}
					remove_district = district_mining
					add_district = district_farming
					add_modifier = { modifier = hc_farming_added days = 360 }																
					
				}						
				if = {
					limit = {
						has_district = district_generator
						num_free_districts = { type = district_farming value > 0 }
						owner = {
							has_monthly_income = {
								resource = energy
								value > 100
							}
							resource_stockpile_compare = {
								resource = energy
								value > 2000
							}
							has_monthly_income = {
								resource = food
								value < 2
							}
						}
					}
					remove_district = district_generator
					add_district = district_farming
					add_modifier = { modifier = hc_farming_added days = 360 }																
					
				}
				if = {
					limit = {
						has_district = district_farming
						num_free_districts = { type = district_generator value > 0 }
						owner = {
							has_monthly_income = {
								resource = energy
								value < 2
							}
							resource_stockpile_compare = {
								resource = energy
								value < 1000
							}
							has_monthly_income = {
								resource = food
								value > 50
							}
							resource_stockpile_compare = {
								resource = food
								value > 2000
							}
						}
					}
					remove_district = district_farming
					add_district = district_generator
					add_modifier = { modifier = hc_generator_added days = 360 }																
					
				}
				
				# Minerals shortages are rare
				if = {
					limit = {
						free_jobs < 4
						num_pops > 25
						or = {
							owner = { has_monthly_income = { resource = minerals value < 1 }}
							and = {
								owner = { has_monthly_income = { resource = minerals value < 20 }}
								owner = { resource_stockpile_compare = { resource = minerals value < 1000 }}
							}
						}
					}
					if = {
						limit = {
							num_free_districts = { type = district_mining value > 0 }
						}
						add_district = district_mining
						add_modifier = { modifier = hc_mining_added days = 360 }
					}
				}

				# Homeworld with too many empty building slots			
				if = {
					limit = {
						or = {
							is_homeworld = yes
							is_capital = yes
						}
						free_building_slots > 4
						free_jobs < 3
						num_pops > 40
					}
					add_building = building_research_lab_1
					add_modifier = { modifier = hc_building_added days = 360 }
				}				
				if = {
					limit = {
						or = {
							is_homeworld = yes
							is_capital = yes
						}
						free_building_slots > 3
						free_jobs < 3
						num_pops > 45
					}
					add_building = building_research_lab_1
					add_modifier = { modifier = hc_building_added days = 360 }
				}
				if = {
					limit = {
						or = {
							is_homeworld = yes
							is_capital = yes
						}
						free_building_slots > 2
						free_jobs < 3
						num_pops > 50
					}
					add_building = building_research_lab_1
					add_modifier = { modifier = hc_building_added days = 360 }
				}				





				# Last resort
				if = {
					limit = {
						num_pops > 36
						free_building_slots > 0
						free_housing < 4
						owner = {
							or = {
								and = {
									has_monthly_income = {
										resource = food
										value < 0
									}
									resource_stockpile_compare = {
										resource = food
										value < 250
									}
								}
								and = {
									has_monthly_income = {
										resource = consumer_goods
										value < 0
									}
									resource_stockpile_compare = {
										resource = consumer_goods
										value < 250
									}
								}
							}
						}
					}
					random_owned_pop = {
						limit = {
							not = { has_job = technician_drone }
							not = { has_job = mining_drone }
							not = { has_job = agri_drone }
							not = { has_job = artisan_drone }
						}
						kill_pop = yes
					}
				}
				
				###Calvitix Ressource Exchange
				if = {
					limit = {
						owner = {
						has_resource = { type = minerals amount > 20000 }
						has_resource = { type = alloys amount < 5000 }
						}
					}
					owner = {
					add_resource = { alloys = 250 }
					add_resource = { minerals = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount > 20000 }
						has_resource = { type = energy amount < 5000 }
						}
					}
					owner = {
					add_resource = { energy = 2500 }
					add_resource = { food = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = consumer_goods amount > 15000 }
						has_resource = { type = energy amount < 5000 }
						}
					}
					owner = {
					add_resource = { energy = 5000 }
					add_resource = { consumer_goods = -5000 }
					}
				}
				
			}
			#Calvitix SuperBonus (When I.A. no more ressource has)
			if = {
				limit = {
					owner = {
					has_resource = { type = energy amount < 500 }
					has_resource = { type = minerals amount < 200 }
					has_resource = { type = food amount < 200 }
					has_monthly_income = { resource = minerals value < 2 }
					has_monthly_income = { resource = energy value < 2 }
					has_monthly_income = { resource = food value < 2 }
					}
				}
				owner = {
					add_resource = { energy = 10000 }
					add_resource = { consumer_goods = 10000 }
					add_resource = { minerals = 10000 }
					add_resource = { food = 10000 }
					add_resource = { alloys = 1000 }
					add_modifier = { modifier = hc_god_hand days = 600 }
				}
			}				
		}
	}
}