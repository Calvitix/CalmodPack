namespace = aihealthcheck




event = {
	id = aihealthcheck.1
	hide_window = yes
	is_triggered_only = yes
	
	immediate = { 

		set_global_flag = edai_logging		
		### Machine Empires
		every_country = {
			limit = {
				is_ai = yes
				is_machine_empire = yes
				not = { is_country_type = primitive }
				not = { is_country_type = fallen_empire }
				not = { is_country_type = awakened_fallen_empire }
				not = { is_country_type = enclave }
				not = { is_country_type = nomad }
				not = { is_country_type = dormant_marauders }
				not = { is_country_type = awakened_marauders }
			}
			random_owned_planet = {
				limit = {
					is_colony = yes
					count_owned_pop = { count >= 5 }
					not = { has_planet_flag = pf_health_checked }
					is_under_colonization = no
				}

				random_list = {
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 270
						}
						add_modifier = {
							modifier = health_checking
							days = 270
						}
					}
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 360
						}
						add_modifier = {
							modifier = health_checking
							days = 360
						}
					}
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 180
						}
						add_modifier = {
							modifier = health_checking
							days = 180
						}
					}
					10 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 90
						}
						add_modifier = {
							modifier = health_checking
							days = 90
						}
					}
				}

				
				#log = "ME: EDAI Check for planet [This.GetName]"
				# Housing shortage - Nexus possible
				if = {
					limit = {
						free_housing < 1
						free_district_slots > 0
						not = { uses_district_set = ring_world } 
						num_free_districts = { type = district_nexus value > 1 }
						not = { has_modifier = hc_city_added }						
					}
					add_district = district_nexus
					owner = { add_resource = { minerals = -500 } }					
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Adding Nexus on planet [This.GetName] for [Owner.GetName]" }
					add_modifier = { modifier = hc_city_added days = 360 }										
					not = { has_modifier = hc_city_added }
				}
				if = {
					limit = {
						free_housing < 1
						free_district_slots > 0
						uses_district_set = ring_world
						num_free_districts = { type = district_rw_nexus value > 1 }
						not = { has_modifier = hc_city_added }						
						
						
					}
					add_district = district_rw_nexus
					owner = { add_resource = { minerals = -500 } }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Adding RW Nexus on planet [This.GetName] for [Owner.GetName]" }					
					add_modifier = { modifier = hc_city_added days = 360 }										
				}
				if = {
					limit = {
						free_housing < 1
						free_district_slots > 0
						uses_district_set = habitat
						num_free_districts = { type = district_hab_housing value > 1 }
						not = { has_modifier = hc_city_added }						
						
					}
					add_district = district_hab_housing
					owner = { add_resource = { minerals = -500 } }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Adding district_hab_housing on planet [This.GetName] for [Owner.GetName]" }					
					add_modifier = { modifier = hc_city_added days = 360 }										
				}
				
				# Early minerals crisis
				if = {
					limit = {
						free_jobs < 10
						owner = { has_monthly_income = { resource = minerals value < -5 }}
						owner = { has_monthly_income = { resource = alloys value > 10 }}
						owner = { resource_stockpile_compare = { resource = minerals value < 1000 } }

						#num_buildings = { type = building_foundry_1 value > 1 }
						num_districts = { type = district_industrial value > 0 }

					}
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: mineral crisis : Removing district_industrial on planet [This.GetName] for [Owner.GetName]" }					
					#remove_building = building_foundry_1
					remove_district = district_industrial
				}

				# Calvitix Zone Commerc Vs Foundry
				if = {
					limit = {
						free_jobs < 10
						#free_amenities > 20
						owner = { has_monthly_income = { resource = alloys value < 5 }}						
						owner = { has_monthly_income = { resource = minerals value > 20 }}
						owner = { resource_stockpile_compare = { resource = alloys value < 1000 } }
						owner = { resource_stockpile_compare = { resource = minerals value > 800 } }
						
					}
					#remove_building = building_commercial_zone
					if = {
						limit = {
							not = { has_modifier = hc_industrial_added }						
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_industrial value > 0 }
							not = { has_modifier = hc_industrial_added }						

						}
						add_district = district_rw_industrial
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Alloys needed : Adding district_rw_industrial on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_industrial_added days = 360 }									
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_industrial_added }						
							free_district_slots > 0
							uses_district_set = habitat
							num_free_districts = { type = district_hab_industrial value > 0 }
						}
						add_district = district_hab_industrial
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Alloys needed : Adding district_hab_industrial on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_industrial_added days = 360 }									
					}
					else_if = { 
						limit = {
							not = { has_modifier = hc_industrial_added }						
							free_district_slots > 0
							num_free_districts = { type = district_industrial value > 0 }
						}						
						add_district = district_industrial
						owner = { add_resource = { minerals = -500 } }
						add_modifier = { modifier = hc_industrial_added days = 360 }										
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Alloys needed : Adding District_industrial on planet [This.GetName] for [Owner.GetName]" }										
					}										
				}

				
				# Early energy crisis
				if = {
					limit = {
						owner = { has_monthly_income = { resource = energy value < -20 }}
						owner = { resource_stockpile_compare = { resource = energy value < 1000 } }
						#owner = { has_monthly_income = { resource = alloys value > 20 }}						
						#has_building = building_foundry_1
						free_jobs < 10
					}					
					if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator value > 0 }
						}
						add_district = district_generator
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Energy Crisis -20 : Adding district_generator on planet [This.GetName] for [Owner.GetName]" }					
						
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					else_if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator_uncapped value > 0 }
						}
						add_district = district_generator_uncapped
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Energy Crisis -20 : Adding district_generator_uncapped on planet [This.GetName] for [Owner.GetName]" }					
						
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_generator value > 0 }
						}
						add_district = district_rw_generator
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Energy Crisis -20 : Adding district_rw_generator on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = habitat
							num_free_districts = { type = district_hab_energy value > 0 }
						}
						add_district = district_hab_energy
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Energy Crisis -20 : Adding district_hab_generator on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							#free_housing > 0
							or = {
								free_jobs < 10
								num_unemployed > 0
								has_unemployed = yes
								}
							free_building_slots > 1
						}
						add_building = eb_energy #energy
						#owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Energy Crisis + Building : Adding building eb_energy on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					
				}
				else_if = {
					limit = {
						free_jobs < 5
						owner = { has_monthly_income = { resource = energy value < 1 }}
						owner = { resource_stockpile_compare = { resource = energy value < 1000 } }
						owner = { resource_stockpile_compare = { resource = minerals value > 800 } }
						#owner = { has_monthly_income = { resource = consumer_goods value > 10 }}						
						#has_building = building_factory_1
					}
					if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator value > 0 }
						}
						add_district = district_generator
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Energy Crisis <1 : Adding district_generator on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_generator value > 0 }
						}
						add_district = district_rw_generator
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Energy Crisis <1 : Adding district_rw_generator on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = habitat
							num_free_districts = { type = district_hab_energy value > 0 }
						}
						add_district = district_hab_energy
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Energy Crisis <1 : Adding district_hab_generator on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}				
					else_if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator_uncapped value > 0 }
						}
						add_district = district_generator_uncapped
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Energy Crisis <1 : Adding district_generator_uncapped on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}					
				}
				
				# Housing shortage = building slot
				if = {
					limit = {
						not = { has_modifier = hc_building_added }						
						free_housing < 1
						free_building_slots > 1
						num_free_districts = { type = district_nexus value < 2 }
					}
					add_building = building_drone_storage
					owner = { add_resource = { minerals = -500 } }					
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Housing Crisis <1 : Adding drone_storage on planet [This.GetName] for [Owner.GetName]" }					
					add_modifier = { modifier = hc_building_added days = 360 }		
				}
				
				# Unemployment
				if = {
					limit = {
						or = {
							free_jobs < 5
							num_unemployed > 0
						}
						owner = { has_monthly_income = { resource = energy value < 30 }}
						owner = { resource_stockpile_compare = { resource = energy value < 5000 } }						
						owner = { resource_stockpile_compare = { resource = minerals value > 800 } }						
					}
					if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }						
							num_free_districts = { type = district_generator value > 0 }
						}
						add_district = district_generator
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low Energy : Adding district_generator on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_generator_added days = 360 }				
					}
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_generator value > 0 }
						}
						add_district = district_rw_generator
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low Energy : Adding district_rw_generator on planet [This.GetName] for [Owner.GetName]" }							
						add_modifier = { modifier = hc_generator_added days = 360 }
					}	
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = habitat
							num_free_districts = { type = district_hab_energy value > 0 }
						}
						add_district = district_hab_energy
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low Energy : Adding district_hab_generator on planet [This.GetName] for [Owner.GetName]" }		
						add_modifier = { modifier = hc_generator_added days = 360 }
					}						
					else_if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }						
							num_free_districts = { type = district_generator_uncapped value > 0 }
						}
						add_district = district_generator_uncapped
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low Energy : Adding district_generator_uncapped on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_generator_added days = 360 }				
					}					
				}
				if = {
					limit = {
						or = {
							free_jobs < 5
							num_unemployed > 0							
							has_unemployed = yes
						}
						owner = { has_monthly_income = { resource = minerals value < 30 }}
						owner = { resource_stockpile_compare = { resource = minerals value < 5000 } }												
						owner = { resource_stockpile_compare = { resource = minerals value > 500 } }
						
					}
					if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							free_district_slots > 0
							not = { uses_district_set = ring_world }						
							num_free_districts = { type = district_mining value > 0 }
							not = { has_modifier = hc_mining_added }						
							
						}
						add_district = district_mining
						owner = { add_resource = { minerals = -300 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low minerals : Adding district_mining on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_mining_added days = 360 }				
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_mining value > 0 }
						}
						add_district = district_rw_mining
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low minerals : Adding district_rw_mining on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_mining_added days = 360 }
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							free_district_slots > 0
							uses_district_set = habitat
							num_free_districts = { type = district_hab_mining value > 0 }
						}
						add_district = district_hab_mining
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low minerals : Adding district_hab_mining on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_mining_added days = 360 }
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							free_district_slots > 0
							uses_district_set = habitat
							num_free_districts = { type = district_hab_mining value > 0 }
						}
						add_district = district_hab_mining
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low minerals : Adding district_hab_mining on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_mining_added days = 360 }
					}
					else_if = {
						limit = {							
							not = { has_modifier = hc_mining_added }						
							free_district_slots > 0
							num_free_districts = { type = district_mining_uncapped value > 0 }
						}
						add_district = district_mining_uncapped
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low minerals : Adding district_mining_uncapped on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_mining_added days = 360 }
					}				
					
					else
					{
						#set_variable = { which = nb_libre_dis value = num_free_districts }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low minerals : pb num_free_districts on planet [This.GetName] for [Owner.GetName]" }					
					}
				}
				#else_if = {
				#		set_variable = { which = nb_chomeurs value = num_unemployed }
				#		if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low minerals : not the case : [This.nb_chomeurs] on planet [This.GetName] for [Owner.GetName]" }					
				#}
				
				###Pollution
				#log = "ME: before pollution for [This.GetName]" 								
				if = {
					limit = {
						or = {
							free_jobs < 5
							num_unemployed > 0
							has_modifier = eco_catastrophic
							has_modifier = eco_waste_high
						}
						or = { 
							has_modifier = eco_heavy
							has_modifier = eco_extreme
							has_modifier = eco_catastrophic
							has_modifier = eco_waste_mod
							has_modifier = eco_waste_high
						}
						or = {
							owner = { has_monthly_income = { resource = energy value > 0 }}
							owner = { resource_stockpile_compare = { resource = energy value > 5000 } }
						}
					}
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Need cleaning pollution on planet [This.GetName] for [Owner.GetName]" }					
					if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							free_building_slots > 1
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						}
						add_building = eco_building_waste_recovery
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Pollution : Adding eco_building_waste_recovery on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_building_added days = 360 }				
						
					}
				}
				
				if = {
					limit = {
						or = {
							free_jobs < 5
							num_unemployed > 0
						}
						owner = { has_monthly_income = { resource = minerals value > 30 }}
						owner = { resource_stockpile_compare = { resource = minerals value > 800 } }
						owner = { 
							or = { 
								has_monthly_income = { resource = alloys value < 30 }
								has_monthly_income = { resource = consumer_goods value < 10}
							}
						}
					}
					if = {
						limit = {
							not = { has_modifier = hc_industrial_added }						
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_industrial value > 0 }
						}
						add_district = district_industrial
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Good Miner. : Adding district_industrial on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_industrial_added days = 360 }				
						
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_industrial_added }						
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_industrial value > 0 }
						}
						add_district = district_rw_industrial
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Good Miner. : Adding district_rw_industrial on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_industrial_added days = 360 }				
					
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_industrial_added }						
							free_district_slots > 0
							uses_district_set = habitat
							num_free_districts = { type = district_hab_industrial value > 0 }
						}
						add_district = district_hab_industrial
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Good Miner. : Adding district_hab_industrial on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_industrial_added days = 360 }				
					
					}					
				}
				if = {
					limit = {
						or = {
							free_jobs < 5
							num_unemployed > 0
						}
						owner = { has_monthly_income = { resource = energy value > 10 }}
					}
					if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							not = { uses_district_set = ring_world }
							owner = { has_monthly_income = { resource = minerals value < 70 }}
							owner = { resource_stockpile_compare = { resource = minerals value < 5000 } }							
							owner = { resource_stockpile_compare = { resource = minerals value > 500 } }
							free_district_slots > 0
							num_free_districts = { type = district_mining value > 0 }
						}
						add_district = district_mining
						owner = { add_resource = { minerals = -300 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low Miner. : Adding district_mining on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_mining_added days = 360 }				
						
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							owner = { has_monthly_income = { resource = minerals value < 70 }}
							owner = { resource_stockpile_compare = { resource = minerals value < 5000 } }							
							owner = { resource_stockpile_compare = { resource = minerals value > 500 } }
							num_free_districts = { type = district_mining_uncapped value > 0 }
						}
						add_district = district_mining_uncapped
						owner = { add_resource = { minerals = -300 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low Miner. : Adding district_mining_uncapped on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_mining_added days = 360 }				
						
					}
					
				}
				if = {
					limit = {
						or = {					
							owner = { country_uses_food = yes }
							owner = { is_catalytic_empire = yes }

							owner = { has_monthly_income = { resource = food value < -2 }}
						}
						or = {
							num_unemployed > 0
							free_jobs < 4
							
						}
						owner = { has_monthly_income = { resource = food value < 5 }}
						owner = { resource_stockpile_compare = { resource = food value < 1000 } }							
						owner = { resource_stockpile_compare = { resource = minerals value > 500 } }						
					}
					if = {
						limit = {
							not = { has_modifier = hc_farming_added }						
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							#owner = { has_monthly_income = { resource = food value < -1 }}
							num_free_districts = { type = district_farming value > 0 }
							
						}
						add_district = district_farming
						owner = { add_resource = { minerals = -300 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low food : Adding district_farming on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_farming_added days = 360 }				
						
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_farming_added }						
							free_district_slots > 0
							#owner = { has_monthly_income = { resource = food value < -1 }}
							num_free_districts = { type = district_farming_uncapped value > 0 }
							not = { uses_district_set = ring_world }
						}
						add_district = district_farming_uncapped
						owner = { add_resource = { minerals = -300 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low food : Adding district_farming_uncapped on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_farming_added days = 360 }				
						
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_farming_added }						
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_farming value > 0 }
						}
						add_district = district_rw_farming
						owner = { add_resource = { minerals = -300 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low food : Adding district_rw_farming on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_farming_added days = 360 }				
						
					}	
					else_if = {
						limit = {
							not = { has_modifier = hc_farming_added }						
							free_building_slots > 1
						}
						add_building = building_hydroponics_farm
						owner = { add_resource = { minerals = -300 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low food : Adding building_hydroponics_farm on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_farming_added days = 360 }				
						
					}					
					else_if = {
						limit = {
							not = { has_modifier = hc_farming_added }						
							free_district_slots > 0
							uses_district_set = habitat
							num_free_districts = { type = district_hab_commercial value > 0 }
							owner = { resource_stockpile_compare = { resource = minerals value > 800 } }						
						}
						add_district = district_hab_commercial
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement  : Adding district_hab_commercial on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_farming_added days = 360 }				
						
					}					
				}
				if = {
					limit = {
						not = { has_modifier = hc_building_added }						
						owner = { has_valid_civic = civic_machine_servitor }
						or = {
							free_jobs < 3
							num_unemployed > 0
						}
						free_building_slots > 0
						owner = { has_monthly_income = { resource = minerals value > 50 }}
						owner = { resource_stockpile_compare = { resource = minerals value > 500 } }												
						owner = { has_monthly_income = { resource = consumer_goods value < 5 }}
					}
					add_building = building_factory_1
					owner = { add_resource = { minerals = -500 } }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Low goods : Adding building_factory_1 on planet [This.GetName] for [Owner.GetName]" }					
					add_modifier = { modifier = hc_building_added days = 360 }		
				}
				if = {
					limit = {
						not = { has_modifier = hc_building_added }						
						free_amenities < 5
						or = {
							free_jobs < 3
							num_unemployed > 0
							}
						free_building_slots > 0
						not = { has_building = building_maintenance_depot }
						owner = { resource_stockpile_compare = { resource = minerals value > 800 } }						
						
					}
					add_building = building_maintenance_depot
					owner = { add_resource = { minerals = -500 } }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + Low services : Adding maintenance_depot on planet [This.GetName] for [Owner.GetName]" }					
					add_modifier = { modifier = hc_building_added days = 360 }		
				}
				if = {
					limit = {
						not = { has_modifier = hc_building_added }						
						planet_crime > 10
						or = {
							num_unemployed > 0
							free_jobs < 14
						}
						free_building_slots > 0
					}
					add_building = building_sentinel_posts
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: High crime : Adding building_sentinel_posts on planet [This.GetName] for [Owner.GetName]" }					
					add_modifier = { modifier = hc_building_added days = 360 }		
				}				
				if = {
					limit = {
						not = { has_modifier = hc_building_added }						
						free_housing > 0
						or = {
							free_jobs < 2
							num_unemployed > 0
							}
						free_building_slots > 4
						owner = { has_monthly_income = { resource = energy value > 50 }}					
						num_buildings = { type = building_research_lab_1 value < 4 }
						owner = { resource_stockpile_compare = { resource = minerals value > 800 } }						
					}
					add_building = building_research_lab_1
					owner = { add_resource = { minerals = -500 } }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Unemployement + energy + Research : Adding building_research_lab_1 on planet [This.GetName] for [Owner.GetName]" }	
					add_modifier = { modifier = hc_building_added days = 360 }		
				}
				
				# Surplus getting in the way
				if = {
					limit = {
						free_housing > 30
						#free_jobs > 2
					}
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Too much Housing (> 30) on planet [This.GetName] for [Owner.GetName]" }							
					if  = {
						limit = {
							free_amenities > 0
							has_building = building_drone_storage
						}
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Too much Housing (> 30) : removing building_drone_storage on planet [This.GetName] for [Owner.GetName]" }							
						remove_building = building_drone_storage					
					}
					else_if = {
						limit = {
							num_districts = { type = district_city value > 1 }
							free_housing > 50
							free_building_slots > 4							
						}					
						remove_district = district_city
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME: Too much Housing (> 50) : removing district_city on planet [This.GetName] for [Owner.GetName]" }												
					}
				}
				
				# Create More Jobs
				if = {
					limit = {
						or = {
							and = {
								free_jobs < 2
								free_building_slots > 1
							}
							and = {
								free_jobs < 3
								free_building_slots > 2
							}
							and = {
								free_jobs < 4
								free_district_slots > 2
							}
							and = {
								free_jobs < 2
								free_district_slots > 1
							}
							and = {
								num_pops > 40
								free_jobs < 1
								free_district_slots < 3
								free_building_slots > 0
								has_building_construction = no
							}
							and = {
								num_pops > 50
								free_jobs < 1
								free_district_slots < 1
								free_building_slots > 0
								has_building_construction = no
							}
						}
					}
					if = {
						limit = {
							not = { has_modifier = hc_industrial_added }						
							num_free_districts = { type = district_industrial value > 0 }
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							owner = { has_monthly_income = { resource = alloys value < 20 }}
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						}
						add_district = district_industrial
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME : Enough room : adding district_industrial on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_industrial_added days = 360 }				
						
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_industrial_added }						
							num_free_districts = { type = district_industrial value > 0 }
							owner = { has_monthly_income = { resource = energy value > 20 }}
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							owner = { has_monthly_income = { resource = consumer_goods value < 20 }}
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}							
						}
						add_district = district_industrial					
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME : Enough room : adding district_industrial on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_industrial_added days = 360 }				
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							not = { has_building = building_research_lab_1 }
							free_building_slots > 2
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
							owner = { has_monthly_income = { resource = energy value > 50 }}
							
						}
						add_building = building_research_lab_1					
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME : Enough room : adding building_research_lab_1 on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							not = { has_building = building_bio_reactor }
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
							free_building_slots > 1
						}
						add_building = building_bio_reactor				
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME : Enough room : adding building_bio_reactor on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							num_buildings = { type = building_research_lab_1 value < 8 }
							free_jobs < 10
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
							owner = { has_monthly_income = { resource = energy value > 20 }}
							free_building_slots > 1
						}
						add_building = building_research_lab_1					
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough room : adding building_research_lab_1 on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							free_building_slots > 1
							not = { has_building = building_foundry_1 }
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
							
						}
						add_building = building_foundry_1
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME : Enough room : adding building_foundry_1 on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							free_building_slots > 1
							not = { has_building = building_factory_1 }
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
							
						}
						add_building = building_factory_1
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :ME : Enough room : adding building_factory_1 on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
				}



				###Calvitix Ressource Exchange
				if = {
					limit = {
						owner = {
						has_resource = { type = minerals amount > 20000 }
						has_resource = { type = alloys amount < 5000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Mach.Empire :  -5000 minerals, +250 alloys for [This.GetName]" }	
					add_resource = { alloys = 250 }
					add_resource = { minerals = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount > 20000 }
						has_resource = { type = energy amount < 5000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Mach.Empire :  -5000 food, +2500  energy for [This.GetName]" }	
					add_resource = { energy = 2500 }
					add_resource = { food = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = consumer_goods amount > 15000 }
						has_resource = { type = energy amount < 5000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Mach.Empire :  -5000 goods, +5000  energy for [This.GetName]" }	
					add_resource = { energy = 5000 }
					add_resource = { consumer_goods = -5000 }
					}
				}
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount < 1000 }
						has_monthly_income = { resource = food value < 1 }						
						has_resource = { type = alloys amount > 20000 }
						has_monthly_income = { resource = alloys value > 30 }						
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Mach.Empire :  -5000 alloys, +5000 food for [This.GetName]" }	
					add_resource = { food = 5000 }
					add_resource = { alloys = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount < 1000 }
						has_monthly_income = { resource = food value < 1 }						
						has_resource = { type = energy amount > 30000 }
						has_monthly_income = { resource = energy value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Mach.Empire :  -5000 energy, +1000 food for [This.GetName]" }	
					add_resource = { food = 1000 }
					add_resource = { energy = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = energy amount < 5000 }
						has_monthly_income = { resource = energy value < 10 }						
						has_resource = { type = alloys amount > 30000 }
						has_monthly_income = { resource = alloys value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Mach.Empire :  +5000 energy, -1000 alloys for [This.GetName]" }	
					add_resource = { alloys = 1000 }
					add_resource = { energy = 5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = volatile_motes amount < 100 }
						has_monthly_income = { resource = volatile_motes value < 3 }						
						has_resource = { type = energy amount > 20000 }
						has_monthly_income = { resource = energy value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Mach.Empire :  -5000 energy, +300 volatile_motes for [This.GetName]" }	
					add_resource = { volatile_motes = 300 }
					add_resource = { energy = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = volatile_motes amount < 100 }
						has_monthly_income = { resource = volatile_motes value < 3 }						
						has_resource = { type = alloys amount > 15000 }
						has_monthly_income = { resource = alloys value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Mach.Empire :  -1000 alloys, +300 volatile_motes for [This.GetName]" }	
					add_resource = { volatile_motes = 300 }
					add_resource = { alloys = -1000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = exotic_gases amount < 100 }
						has_monthly_income = { resource = exotic_gases value < 3 }						
						has_resource = { type = energy amount > 20000 }
						has_monthly_income = { resource = energy value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Mach.Empire :  -5000 energy, +300 exotic_gases for [This.GetName]" }	
					add_resource = { exotic_gases = 300 }
					add_resource = { energy = -5000 }
					}
				}			
				
				
				if = {
					limit = {
						owner = {
						has_resource = { type = exotic_gases amount < 100 }
						has_monthly_income = { resource = exotic_gases value < 3 }						
						has_resource = { type = alloys amount > 15000 }
						has_monthly_income = { resource = alloys value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Mach.Empire :  -1000 alloys, +300 exotic_gases for [This.GetName]" }	
					add_resource = { exotic_gases = 300 }
					add_resource = { alloys = -1000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = rare_crystals amount < 100 }
						has_monthly_income = { resource = rare_crystals value < 3 }						
						has_resource = { type = energy amount > 20000 }
						has_monthly_income = { resource = energy value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Mach.Empire :  -5000 energy, +300 rare_crystals for [This.GetName]" }	
					add_resource = { rare_crystals = 300 }
					add_resource = { energy = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = rare_crystals amount < 100 }
						has_monthly_income = { resource = rare_crystals value < 3 }						
						has_resource = { type = alloys amount > 15000 }
						has_monthly_income = { resource = alloys value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Mach.Empire :  -1000 alloys, +300 rare_crystals for [This.GetName]" }	
					add_resource = { rare_crystals = 300 }
					add_resource = { alloys = -1000 }
					}
				}

				#High Level Stockpiles
				if = {
					limit = {
						owner = {
						has_resource = { type = consumer_goods amount > 80000 }
						has_monthly_income = { resource = consumer_goods value > 150 }						
						has_resource = { type = alloys amount < 50000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade H.level : Mach.Empire :  -20000 consumer_goods, + 5000 alloys for [This.GetName]" }	
					add_resource = { consumer_goods = -20000 }
					add_resource = { alloys = 5000 }
					}
				}			
				#High Level Stockpiles
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount > 80000 }
						has_monthly_income = { resource = food value > 150 }						
						has_resource = { type = alloys amount < 50000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade H.level : Mach.Empire :  -20000 food, + 5000 alloys for [This.GetName]" }	
					add_resource = { food = -20000 }
					add_resource = { alloys = 5000 }
					}
				}			
				#High Level Stockpiles
				if = {
					limit = {
						owner = {
						has_resource = { type = consumer_goods amount > 80000 }
						has_monthly_income = { resource = consumer_goods value > 150 }						
						has_resource = { type = energy amount < 50000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade H.level : Mach.Empire :  -20000 consumer_goods, + 10000  energy for [This.GetName]" }	
					add_resource = { consumer_goods = -20000 }
					add_resource = { energy = 10000 }
					}
				}			
				#High Level Stockpiles
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount > 80000 }
						has_monthly_income = { resource = food value > 150 }						
						has_resource = { type = energy amount < 50000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade H.level : Mach.Empire :  -20000 food, + 15000  energy for [This.GetName]" }	
					add_resource = { food = -20000 }
					add_resource = { energy = 15000 }
					}
				}	
				
			}			
			
				

			
			
			
			#Calvitix SuperBonus (When I.A. no more ressource has)
			if = {
				limit = {
					owner = {
					or = {
						and = {
						has_resource = { type = energy amount < 500 }
						has_resource = { type = minerals amount < 200 }
						has_resource = { type = food amount < 200 }
						has_monthly_income = { resource = minerals value < 2 }
						has_monthly_income = { resource = energy value < 2 }
						has_monthly_income = { resource = food value < 2 }
						}
						and = {
						has_resource = { type = energy amount < 50 }
						has_resource = { type = alloys amount < 20 }
						has_resource = { type = food amount < 20 }
						has_monthly_income = { resource = alloys value < 0 }
						has_monthly_income = { resource = food value < 0 }
						has_monthly_income = { resource = energy value < 0 }
						}
					}
					}
				}
				owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Mach.Empire : Hand of God +10000 Superbonus for [This.GetName]" }	
					add_resource = { energy = 10000 }
					add_resource = { consumer_goods = 10000 }
					add_resource = { minerals = 10000 }
					add_resource = { food = 10000 }
					add_resource = { alloys = 1000 }
					#add_modifier = { modifier = hc_god_hand days = 600 }
				}
			}
		}
		### END Machine Empires
		
		### Regular Empires
		every_country = {
			limit = {
				is_ai = yes
				is_regular_empire = yes
				not = { is_country_type = primitive }
				not = { is_country_type = fallen_empire }
				not = { is_country_type = awakened_fallen_empire }
				not = { is_country_type = enclave }
				not = { is_country_type = nomad }
				not = { is_country_type = dormant_marauders }
				not = { is_country_type = awakened_marauders }
			}
			random_owned_planet = {
				limit = {
					is_colony = yes
					num_pops > 4
					not = { has_planet_flag = pf_health_checked }
					is_under_colonization = no
				}
				#log = "E: EDAI Check for planet [This.GetName]"

				random_list = {
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 270
						}
						add_modifier = {
							modifier = health_checking
							days = 270
						}
					}
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 360
						}
						add_modifier = {
							modifier = health_checking
							days = 360
						}
					}
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 180
						}
						add_modifier = {
							modifier = health_checking
							days = 180
						}
					}
					10 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 90
						}
						add_modifier = {
							modifier = health_checking
							days = 90
						}
					}
				}
				
				# Early energy crisis
				if = {
					limit = {
						owner = { has_monthly_income = { resource = energy value < -20 }}
						owner = { resource_stockpile_compare = { resource = energy value < 1000 } }
						#owner = { has_monthly_income = { resource = alloys value > 20 }}						
						#has_building = building_foundry_1
						free_jobs < 10
					}					
					if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator value > 0 }							
						}
						add_district = district_generator
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Energy Crisis -20 : adding district_generator on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator_uncapped value > 0 }
						}
						add_district = district_generator_uncapped
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Energy Crisis -20 : adding district_generator_uncapped on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					if = {
						limit = {
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_generator value > 0 }
						}
						add_district = district_rw_generator
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Energy Crisis -20 : adding district_rw_generator on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}	
					if = {
						limit = {
							free_district_slots > 0
							uses_district_set = habitat
							num_free_districts = { type = district_hab_energy value > 0 }
						}
						add_district = district_hab_energy
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Energy Crisis -20 : adding district_hab_generator on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}	
					if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							#free_housing > 0
							or = {
								free_jobs < 10
								num_unemployed > 0
								}
							free_building_slots > 1
						}
						add_building = eb_energy #energy
						#owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Energy Crisis + Building : Adding building eb_energy on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					
				}
				else_if = {
					limit = {
						free_jobs < 5
						owner = { has_monthly_income = { resource = energy value < 1 }}
						owner = { resource_stockpile_compare = { resource = minerals value > 800 } }												
						#owner = { has_monthly_income = { resource = consumer_goods value > 10 }}						
						#has_building = building_factory_1
					}
					if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator value > 0 }
						}
						add_district = district_generator
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Energy Crisis < 1 : adding district_generator on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_generator value > 0 }
						}
						add_district = district_rw_generator
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Energy Crisis < 1 : adding district_rw_generator on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}					
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = habitat
							num_free_districts = { type = district_hab_energy value > 0 }
						}
						add_district = district_hab_energy
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Energy Crisis < 1 : adding district_hab_generator on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}
					else_if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator_uncapped value > 0 }
						}
						add_district = district_generator_uncapped
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Energy Crisis < 1 : adding district_generator_uncapped on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}					
				}


				# Early minerals crisis
				# Make artisans and metallurgists into miners
				if = {
					limit = {
						free_jobs < 5						
						owner = { has_monthly_income = { resource = minerals value < -5 }}
						owner = { resource_stockpile_compare = { resource = minerals value < 1000 } }
						owner = { has_monthly_income = { resource = alloys value > 10 }}						
						num_districts = { type = district_industrial value > 1 }
					}
					if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							free_district_slots > 0
							num_free_districts = { type = district_mining value > 0 }
						}
						add_district = district_mining
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Minerals Crisis < -5 : adding district_mining, on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_mining_added days = 360 }
						#remove_district = district_industrial
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							free_district_slots > 0
							num_free_districts = { type = district_mining_uncapped value > 0 }
						}
						add_district = district_mining_uncapped
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Minerals Crisis < -5 : adding district_mining_uncapped, on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_mining_added days = 360 }
						#remove_district = district_industrial
					}					
				}
				if = {
					limit = {
						free_jobs < 5
						owner = { has_monthly_income = { resource = minerals value < -20 }}
						#has_building = building_factory_1
					}
					if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							free_district_slots > 0
							owner = { has_monthly_income = { resource = minerals value < -20 }}
							num_free_districts = { type = district_mining value > 0 }
						}
						add_district = district_mining
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Minerals Crisis < -20 : adding district_mining on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_mining_added days = 360 }				
						#remove_building = building_factory_1
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							free_district_slots > 0
							owner = { has_monthly_income = { resource = minerals value < -20 }}
							num_free_districts = { type = district_mining_uncapped value > 0 }
						}
						add_district = district_mining
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Minerals Crisis < -20 : adding district_mining_uncapped on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_mining_added days = 360 }				
						#remove_building = building_factory_1
					}					
				}
				
				# Early CGs crisis
				# Make researchers into artisans
				if = {
					limit = {
						not = { has_modifier = hc_industrial_added }						
						free_district_slots > 0
						not = { uses_district_set = ring_world }
						owner = { has_monthly_income = { resource = alloys value < 0 }}
						owner = { has_monthly_income = { resource = minerals value > 50 }}
						has_building = building_research_lab_1
						num_free_districts = { type = district_industrial value > 0 }		
					}
					remove_building = building_research_lab_1
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : alloy Crisis < -20 : adding district_industrial, removing research_lab on planet [This.GetName] for [Owner.GetName]" }	
					add_district = district_industrial
					owner = { add_resource = { minerals = -500 } }
					add_modifier = { modifier = hc_industrial_added days = 360 }				
					
				}
				if = {
					limit = {
						not = { has_modifier = hc_industrial_added }						
						free_district_slots > 0
						uses_district_set = ring_world
						owner = { has_monthly_income = { resource = alloys value < 0 }}
						owner = { has_monthly_income = { resource = minerals value > 50 }}
						has_building = building_research_lab_1
						num_free_districts = { type = district_rw_industrial value > 0 }		
					}
					remove_building = building_research_lab_1
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : alloy Crisis < -20 : adding district_rw_industrial, removing research_lab on planet [This.GetName] for [Owner.GetName]" }	
					add_district = district_industrial
					owner = { add_resource = { minerals = -500 } }
					add_modifier = { modifier = hc_industrial_added days = 360 }				
					
				}
				
				# Calvitix Zone Commerc Vs Foundry
				if = {
					limit = {
						not = { has_modifier = hc_industrial_added }						
						free_jobs > 1
						free_amenities > 20
						free_district_slots > 0
						owner = { has_monthly_income = { resource = alloys value < -20 }}						
						owner = { has_monthly_income = { resource = minerals value > 30 }}
						owner = { has_monthly_income = { resource = energy value > 50 }}
						num_buildings = { type = building_commercial_zone value > 1 }
						num_free_districts = { type = district_industrial value > 0 }								
					}
					remove_building = building_commercial_zone
					add_district = district_industrial
					owner = { add_resource = { minerals = -500 } }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : alloy Crisis < -20 : adding district_industrial, removing commercial on planet [This.GetName] for [Owner.GetName]" }	
					add_modifier = { modifier = hc_industrial_added days = 360 }				
					
				}

				###Pollution
				#log = "E: before pollution for [This.GetName]"
				if = {
					limit = {
						or = {
							free_jobs < 5
							num_unemployed > 0

							has_modifier = eco_catastrophic
							has_modifier = eco_waste_high
						}
						or = { 
							has_modifier = eco_moderate
							has_modifier = eco_heavy
							has_modifier = eco_extreme
							has_modifier = eco_catastrophic
							has_modifier = eco_waste_mod
							has_modifier = eco_waste_high
						}
						owner = { has_monthly_income = { resource = energy value > 0 }}
					}
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Need cleaning pollution on planet [This.GetName] for [Owner.GetName]" }					
					if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						}
						add_building = eco_building_waste_recovery
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployement + Pollution : Adding eco_building_waste_recovery on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_building_added days = 360 }				
						
					}
				}


				# Crime and Instability
				if = {
					limit = {
						or = {
							planet_crime > 20
							and = {
								planet_crime > 10
								planet_stability < 50
							}
						}
						not = { has_building = building_precinct_house }
						not = { has_building = building_hall_judgment }
					}
					if = {
						limit = { 
							not = { has_modifier = hc_building_added }						
							free_building_slots > 0
							free_jobs < 1
						}
						add_building = building_precinct_house
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : High Crime > 20 : adding building_precinct_house on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							has_building = building_holo_theatres 
						}
						remove_building = building_holo_theatres
						add_building = building_precinct_house
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : High Crime > 20 : adding building_precinct_house, removing building_holo_theatres on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					else_if = {
						limit = { 
							has_building = building_research_lab_1 
							not = { has_modifier = hc_building_added }						
						}
						remove_building = building_research_lab_1
						add_building = building_precinct_house
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : High Crime > 20 : adding building_precinct_house, removing building_research_lab_1 on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					else_if = {
						limit = { 
							not = { has_modifier = hc_building_added }						
							#num_buildings = { type = building_foundry_1 value > 1 }
							free_building_slots > 0
							#owner = { has_monthly_income = { resource = alloys value > 20 }}	
						}
						#remove_building = building_foundry_1
						add_building = building_precinct_house
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : High Crime > 20 : adding building_precinct_house on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}					
				}
				
				# Amenities
				if = {
					limit = {
						or = {
							free_amenities < 1
							and = {
								free_amenities < 5
								planet_stability < 25
							}
						}
						not = { has_building = building_holo_theatres }
						not = { has_building = building_hyper_entertainment_forum }
						
					}
					if = {
						limit = { 
							not = { has_modifier = hc_building_added }						
							free_building_slots > 0
							free_jobs < 1
							owner = { resource_stockpile_compare = { resource = minerals value > 500 } }						
							
						}
						add_building = building_holo_theatres
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Low Services < 5 : adding building_holo_theatres on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					else_if = {
						limit = { 
							has_building = building_research_lab_1 
							not = { has_modifier = hc_building_added }													
						}
						remove_building = building_research_lab_1
						add_building = building_holo_theatres						
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Low Services < 5 : adding building_holo_theatres, removing building_research_lab_1 on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					else_if = {
						limit = { 
							not = { has_modifier = hc_building_added }						
							free_building_slots > 0
							#num_buildings = { type = building_foundry_1 value > 2 }
							#owner = { has_monthly_income = { resource = alloys value > 15 }}
							owner = { resource_stockpile_compare = { resource = minerals value > 500 } }						
							
						}
						#remove_building = building_foundry_1
						add_building = building_holo_theatres
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Low Services < 5 : adding building_holo_theatres on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}					
				}
				
				# Create More Jobs
				if = {
					limit = {
						or = {
							and = {
								free_jobs < 2
								free_building_slots > 1
							}
							and = {
								free_jobs < 3
								free_building_slots > 2
							}
							and = {
								free_jobs < 4
								free_district_slots > 2
							}
							and = {
								free_jobs < 2
								free_district_slots > 1
							}
							and = {
								num_pops > 40
								free_jobs < 1
								free_district_slots < 3
								free_building_slots > 0
								has_building_construction = no
							}
							and = {
								num_pops > 50
								free_jobs < 1
								free_district_slots < 1
								free_building_slots > 0
								has_building_construction = no
							}
						}
					}
					if = {
						limit = {
							free_district_slots > 0
							num_free_districts = { type = district_industrial value > 0 }
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							owner = { has_monthly_income = { resource = alloys value < 20 }}
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						}
						add_district = district_industrial
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough room : adding district_industrial on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_industrial_added days = 360 }				
						
					}
					else_if = {
						limit = {
							free_district_slots > 0
							num_free_districts = { type = district_industrial value > 0 }
							owner = { has_monthly_income = { resource = energy value > 20 }}
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							owner = { has_monthly_income = { resource = consumer_goods value < 20 }}
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}							
						}
						add_district = district_industrial					
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough room : adding district_industrial on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_industrial_added days = 360 }				
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							not = { has_building = building_research_lab_1 }
							free_building_slots > 2
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
							owner = { has_monthly_income = { resource = energy value > 50 }}
							
						}
						add_building = building_research_lab_1					
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough room : adding building_research_lab_1 on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							not = { has_building = building_holo_theatres }
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
							free_building_slots > 1
						}
						add_building = building_holo_theatres				
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough room : adding building_holo_theatres on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							num_buildings = { type = building_research_lab_1 value < 4 }
							free_jobs < 10
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
							owner = { has_monthly_income = { resource = energy value > 20 }}
							free_building_slots > 1
						}
						add_building = building_research_lab_1					
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough room : adding building_research_lab_1 on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							free_building_slots > 1
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
							
						}
						add_building = building_commercial_zone
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough room : adding building_commercial_zone on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
				}
				
				# Unemployment
				if = {
					limit = { any_owned_pop = { is_unemployed = yes }}
					if = {
						limit = { 
							owner = { has_monthly_income = { resource = energy value < 50 }}
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						}
						if = {
							limit = {
								free_district_slots > 0
								not = { uses_district_set = ring_world }
								num_free_districts = { type = district_generator value > 0 }
							}
							add_district = district_generator
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low Energy : adding district_generator on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_generator_added days = 360 }				
						}
						else_if = {
							limit = {
								free_district_slots > 0
								uses_district_set = ring_world
								num_free_districts = { type = district_rw_generator value > 0 }
							}
							add_district = district_rw_generator
							owner = { add_resource = { minerals = -500 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low Energy : adding district_rw_generator on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_generator_added days = 360 }											
						}
						else_if = {
							limit = {
								free_district_slots > 0
								uses_district_set = habitat
								num_free_districts = { type = district_hab_energy value > 0 }
							}
							add_district = district_hab_energy
							owner = { add_resource = { minerals = -500 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low Energy : adding district_hab_generator on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_generator_added days = 360 }											
						}
						else_if = {
							limit = {
								free_district_slots > 0
								not = { uses_district_set = ring_world }
								num_free_districts = { type = district_generator_uncapped value > 0 }
								
							}
							add_district = district_generator_uncapped
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low Energy : adding district_generator_uncapped on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_generator_added days = 360 }				
						}						
					}
					else_if = {
						limit = {
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}							
							owner = { has_monthly_income = { resource = alloys value < 20 }}
						}
						if = {
							limit = {
								free_district_slots > 0
								not = { uses_district_set = ring_world }
								num_free_districts = { type = district_industrial value > 0 }
							}
							add_district = district_industrial
						owner = { add_resource = { minerals = -500 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low alloy : adding district_industrial on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_industrial_added days = 360 }				
						}
						else_if = {
							limit = {
								free_district_slots > 0
								uses_district_set = ring_world
								num_free_districts = { type = district_rw_industrial value > 0 }
							}
							add_district = district_rw_industrial
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low alloy : adding district_rw_industrial on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_industrial_added days = 360 }											
						}
						else_if = {
							limit = {
								free_district_slots > 0
								uses_district_set = habitat
								num_free_districts = { type = district_hab_industrial value > 0 }
							}
							add_district = district_hab_industrial
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low alloy : adding district_hab_industrial on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_industrial_added days = 360 }											
						}						
					}					
					if = {
						limit = { 
							owner = { has_monthly_income = { resource = food value < 0 }}
							owner = { resource_stockpile_compare = { resource = food value < 1000 } }														
							owner = { resource_stockpile_compare = { resource = minerals value > 500 }}							
						}
						if = {
							limit = {
								not = { has_modifier = hc_farming_added }						
								free_district_slots > 0
								not = { uses_district_set = ring_world }
								num_free_districts = { type = district_farming value > 0 }
							}
							add_district = district_farming
						owner = { add_resource = { minerals = -300 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low food : adding district_farming on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_farming_added days = 360 }				
						}
						else_if = {
							limit = {
								not = { has_modifier = hc_farming_added }						
								free_district_slots > 0
								not = { uses_district_set = ring_world }
								num_free_districts = { type = district_farming_uncapped value > 0 }
							}
							add_district = district_farming_uncapped
							owner = { add_resource = { minerals = -300 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low food : adding district_farming_uncapped on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_farming_added days = 360 }				
						}
						else_if = {
							limit = {
								not = { has_modifier = hc_farming_added }						
								free_district_slots > 0
								uses_district_set = ring_world
								num_free_districts = { type = district_rw_farming value > 0 }
							}
							add_district = district_rw_farming
							owner = { add_resource = { minerals = -300 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low food : adding district_farming on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_farming_added days = 360 }				
						}	
						else_if = {
							limit = {
								not = { has_modifier = hc_farming_added }						
								free_building_slots > 1
							}
							add_building = building_hydroponics_farm
							owner = { add_resource = { minerals = -300 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployement + Low food : Adding building_hydroponics_farm on planet [This.GetName] for [Owner.GetName]" }					
							add_modifier = { modifier = hc_farming_added days = 360 }				
							
						}					
						
					}
					if = {
						limit = { 
							owner = { has_monthly_income = { resource = minerals value < 0 }}
						}
						if = {
							limit = {
								not = { has_modifier = hc_mining_added }						
								free_district_slots > 0
								not = { uses_district_set = ring_world }
								num_free_districts = { type = district_mining value > 0 }
							}
							add_district = district_mining
							owner = { add_resource = { minerals = -300 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low minerals : Adding district_mining on planet [This.GetName] for [Owner.GetName]" }
							add_modifier = { modifier = hc_mining_added days = 360 }				
						}
						else_if = {
							limit = {
								not = { has_modifier = hc_mining_added }						
								free_district_slots > 0
								uses_district_set = ring_world
								num_free_districts = { type = district_rw_mining value > 0 }
							}
							add_district = district_rw_mining
							owner = { add_resource = { minerals = -300 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low minerals : Adding district_rw_mining on planet [This.GetName] for [Owner.GetName]" }
							add_modifier = { modifier = hc_mining_added days = 360 }				
						}
						else_if = {
							limit = {
								not = { has_modifier = hc_mining_added }						
								free_district_slots > 0
								uses_district_set = habitat
								num_free_districts = { type = district_hab_mining value > 0 }
							}
							add_district = district_hab_mining
							owner = { add_resource = { minerals = -300 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low minerals : Adding district_hab_mining on planet [This.GetName] for [Owner.GetName]" }
							add_modifier = { modifier = hc_mining_added days = 360 }				
						}						
						else_if = {
							limit = {
								not = { has_modifier = hc_mining_added }						
								free_district_slots > 0
								not = { uses_district_set = ring_world }
								num_free_districts = { type = district_mining_uncapped value > 0 }
							}
							add_district = district_mining_uncapped
							owner = { add_resource = { minerals = -300 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low minerals : Adding district_mining_uncapped on planet [This.GetName] for [Owner.GetName]" }
							add_modifier = { modifier = hc_mining_added days = 360 }				
						}						
					}
					else_if = {
						limit = {
							free_district_slots > 0
							#num_buildings = { type = building_foundry_1 value < 5 }
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}							
							owner = { has_monthly_income = { resource = alloys value < 20 }}
							num_free_districts = { type = district_industrial value > 0 }								
						}
						add_district = district_industrial
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low alloy : Adding district_industrial on planet [This.GetName] for [Owner.GetName]" }
						add_modifier = { modifier = hc_industrial_added days = 360 }				
					}
					else_if = {
						limit = { 
							free_district_slots > 0
							#num_buildings = { type = building_factory_1 value < 4 }
							owner = { has_monthly_income = { resource = consumer_goods value < 20 }}
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							num_free_districts = { type = district_industrial value > 0 }
							
						}
						add_district = district_industrial
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low goods : Adding district_industrial on planet [This.GetName] for [Owner.GetName]" }
						add_modifier = { modifier = hc_industrial_added days = 360 }				
					}
					else_if = {
						limit = { 
							not = { has_modifier = hc_building_added }						
							free_building_slots > 1 
						}
						if = {
							limit = { num_buildings = { type = building_research_lab_1 value < 4 } }
							add_building = building_research_lab_1	
							owner = { add_resource = { minerals = -500 } }
							owner = { has_monthly_income = { resource = energy value > 50 }}
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & Research : Adding building_research_lab_1 on planet [This.GetName] for [Owner.GetName]" }							
							add_modifier = { modifier = hc_building_added days = 360 }		
						}
						else_if = {
							limit = {
								not = { has_modifier = hc_building_added }						
								not = { has_building = building_holo_theatres }
								free_amenities < 10
							}
							add_building = building_holo_theatres				
							owner = { add_resource = { minerals = -500 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment & low services : Adding building_holo_theatres on planet [This.GetName] for [Owner.GetName]" }							
							add_modifier = { modifier = hc_building_added days = 360 }		
						}
						else = { 
							add_building = building_commercial_zone
							owner = { add_resource = { minerals = -500 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Unemployment : Adding building_commercial_zone on planet [This.GetName] for [Owner.GetName]" }							
							add_modifier = { modifier = hc_building_added days = 360 }		
						}
					}					
				}
				
				
				# Uncleared blockers - just get rid of them
				if = {
					limit = { free_district_slots < 2 }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Need to clear blocker on planet [This.GetName] for [Owner.GetName]" }
					clear_blockers = yes
				}
				
				# Economic Fine Tuning - surplus is wasting space
				if = {
					limit = {
						free_housing > 4
						free_jobs > 3
						free_district_slots < 5
						not = { any_owned_pop = { is_unemployed = yes }}
					}
					if = {
						limit = {
							has_district = district_farming
							owner = {
								has_monthly_income = {
									resource = food
									value > 150
								}
								resource_stockpile_compare = {
									resource = food
									value > 5000
								}
							}
						}
						remove_district = district_farming
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough food : Removing district_farming on planet [This.GetName] for [Owner.GetName]" }					
						
					}
				}
				if = {
					limit = {
						free_housing > 3
						free_jobs > 3
						free_district_slots < 2
						not = { any_owned_pop = { is_unemployed = yes }}
					}
					if = {
						limit = {
							has_district = district_mining
							owner = {
								has_monthly_income = {
									resource = minerals
									value > 500
								}
								resource_stockpile_compare = {
									resource = minerals
									value > 12000
								}
							}
						}
						remove_district = district_mining
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough minerals : Removing district_mining on planet [This.GetName] for [Owner.GetName]" }					
						
					}
				}
				if = {
					limit = {
						free_housing > 3
						free_jobs > 3
						free_district_slots < 2
						not = { any_owned_pop = { is_unemployed = yes }}
					}
					if = {
						limit = {
							has_district = district_generator
							owner = {
								has_monthly_income = {
									resource = energy
									value > 250
								}
								resource_stockpile_compare = {
									resource = energy
									value > 10000
								}
							}
						}
						remove_district = district_generator
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough energy : Removing district_generator on planet [This.GetName] for [Owner.GetName]" }					
						
					}
					if = {
						limit = {
							has_district = district_generator_uncapped
							owner = {
								has_monthly_income = {
									resource = energy
									value > 250
								}
								resource_stockpile_compare = {
									resource = energy
									value > 10000
								}
							}
						}
						remove_district = district_generator_uncapped
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough energy : Removing district_generator_uncapped on planet [This.GetName] for [Owner.GetName]" }					
						
					}
					
				}
				
				# Housing
				if = {
					limit = {
						free_housing < 1
					}
					if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							owner = { not = { has_origin = origin_gas_giant } }
							num_free_districts = { type = district_city value > 0 }
						}
						add_district = district_city
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Housing needed : Adding district_city on planet [This.GetName] for [Owner.GetName]" }							
						add_modifier = { modifier = hc_city_added days = 360 }				
					}
					else_if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							owner = { has_origin = origin_gas_giant }
							num_free_districts = { type = district_giga_planet_city value > 0 }
						}
						add_district = district_giga_planet_city
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Housing needed : Adding district_giga_city on planet [This.GetName] for [Owner.GetName]" }							
						add_modifier = { modifier = hc_city_added days = 360 }				
					}
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_city value > 0 }
						}
						add_district = district_rw_city
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Housing needed : Adding district_rw_city on planet [This.GetName] for [Owner.GetName]" }							
						add_modifier = { modifier = hc_city_added days = 360 }				
					}
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = habitat
							num_free_districts = { type = district_hab_housing value > 0 }
						}
						add_district = district_hab_housing
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Housing needed : Adding district_hab_housing on planet [This.GetName] for [Owner.GetName]" }							
						add_modifier = { modifier = hc_city_added days = 360 }				
					}					
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_nexus value > 0 }
						}
						add_district = district_rw_nexus
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Housing needed : Adding district_rw_nexus for [This.GetName] - don't happen normally" }							
						add_modifier = { modifier = hc_city_added days = 360 }									
					}
				}
				else_if = {
					limit = { free_housing < -1 }
					clear_blockers = yes
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Housing needed : clearing blockers on planet [This.GetName] for [Owner.GetName]" }							
					
				}
				
				# Overcrowding - pointless unemployed homeless pops lags up the game
				if = {
					limit = {
						any_owned_pop = { is_unemployed = yes }
						free_building_slots < 1
						free_district_slots < 1
						num_pops > 182
						free_housing < 0
					}
					random_owned_pop = {
						limit = { is_unemployed = yes }
						kill_pop = yes
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : WARNING > 180 pops : killing unemployed on planet [This.GetName] for [Owner.GetName]" }							
						
					}
					random_owned_pop = {
						limit = { is_unemployed = yes }
						kill_pop = yes
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : WARNING > 180 pops : killing unemployed on planet [This.GetName] for [Owner.GetName]" }							
						
					}
					random_owned_pop = {
						limit = { is_unemployed = yes }
						kill_pop = yes
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : WARNING > 180 pops : killing unemployed on planet [This.GetName] for [Owner.GetName]" }							
					}
				}
				
				# Surplus getting in the way
				if = {
					limit = {
						free_housing > 30
						num_districts = { type = district_city value > 0 }
						#free_jobs > 2
					}
					if  = {
						limit = {
							free_amenities > 5
							has_building = ebh_slums_1
						}
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Too much Housing (> 30) : removing slum building on planet [This.GetName] for [Owner.GetName]" }							
						remove_building = ebh_slums_1					
					}
					else_if = {
						limit = {
							num_districts = { type = district_city value > 1 }
							free_housing > 50
							free_building_slots > 4							
						}					
						remove_district = district_city
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Too much Housing (> 50) : removing district_city on planet [This.GetName] for [Owner.GetName]" }												
					}
				}
				if = {
					limit = {
						has_building = building_commercial_zone
						free_jobs > 4
						free_amenities > 25
						owner = {
							has_monthly_income = {
								resource = energy
								value > 150
							}
							has_monthly_income = {
								resource = consumer_goods
								value > 75
							}
						}
					}
					remove_building = building_commercial_zone
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Too much services (> 30) : removing building_commercial_zone on planet [This.GetName] for [Owner.GetName]" }							
					
				}
				
				# Shortages rectified by removing surplus
				# Make workers change jobs
				if = {
					limit = {
						not = { has_modifier = hc_farming_added }						
						num_districts = { type = district_mining value > 0 }
						num_free_districts = { type = district_farming value > 0 }
						owner = {
							has_monthly_income = { resource = minerals value > 80 }
							resource_stockpile_compare = { resource = minerals value > 1000 }
							has_monthly_income = { resource = food value < 2 }
							owner = { resource_stockpile_compare = { resource = food value < 1000 } }														
						}
					}
					remove_district = district_mining
					add_district = district_farming
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough mining & low food : Adding district_farming and removing district_mining on planet [This.GetName] for [Owner.GetName]" }							
					add_modifier = { modifier = hc_farming_added days = 360 }				
					
				}						
				if = {
					limit = {
						not = { has_modifier = hc_farming_added }						
						has_district = district_generator
						num_free_districts = { type = district_farming value > 0 }
						owner = {
							has_monthly_income = {
								resource = energy
								value > 100
							}
							resource_stockpile_compare = {
								resource = energy
								value > 2000
							}
							has_monthly_income = {
								resource = food
								value < 2
							}
							resource_stockpile_compare = { resource = food value < 1000 }							
						}
					}
					remove_district = district_generator
					add_district = district_farming
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough energy & low food : Adding district_farming and removing district_generator on planet [This.GetName] for [Owner.GetName]" }							
					add_modifier = { modifier = hc_farming_added days = 360 }									
				}
				if = {
					limit = {
						has_district = district_farming
						num_free_districts = { type = district_generator value > 0 }
						owner = {
							has_monthly_income = {
								resource = energy
								value < 2
							}
							resource_stockpile_compare = {
								resource = energy
								value < 1000
							}
							has_monthly_income = {
								resource = food
								value > 50
							}
							resource_stockpile_compare = {
								resource = food
								value > 1000
							}
						}
					}
					remove_district = district_farming
					add_district = district_generator
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough food & low Energy : Adding district_generator and removing district_farming on planet [This.GetName] for [Owner.GetName]" }							
					add_modifier = { modifier = hc_generator_added days = 360 }				
					
				}
				
				# Minerals shortages are rare
				if = {
					limit = {
						free_jobs < 4
						num_pops > 25
						or = {
							owner = { has_monthly_income = { resource = minerals value < 1 }}
							and = {
								owner = { has_monthly_income = { resource = minerals value < 20 }}
								owner = { resource_stockpile_compare = { resource = minerals value < 1000 }}
							}
						}
					}
					if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							num_free_districts = { type = district_mining value > 0 }
						}
						add_district = district_mining
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : low minerals : Adding district_mining on planet [This.GetName] for [Owner.GetName]" }							
						add_modifier = { modifier = hc_mining_added days = 360 }				
						
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							num_free_districts = { type = district_mining_uncapped value > 0 }
						}
						add_district = district_mining_uncapped
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : low minerals : Adding district_mining_uncapped on planet [This.GetName] for [Owner.GetName]" }							
						add_modifier = { modifier = hc_mining_added days = 360 }				
						
					}					
				}

				# Homeworld with too many empty building slots			
				if = {
					limit = {
						not = { has_modifier = hc_building_added }						
						or = {
							is_homeworld = yes
							is_capital = yes
						}
						free_building_slots > 3
						free_jobs < 3
						num_pops > 40
						owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						owner = { has_monthly_income = { resource = energy value > 50 }}
						
					}
					add_building = building_research_lab_1
					owner = { add_resource = { minerals = -500 } }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough room : Adding building_research_lab_1 on planet [This.GetName] for [Owner.GetName]" }							
					add_modifier = { modifier = hc_building_added days = 360 }				
				}				
				if = {
					limit = {
						not = { has_modifier = hc_building_added }						
						or = {
							is_homeworld = yes
							is_capital = yes
						}
						free_building_slots > 3
						free_jobs < 3
						num_pops > 45
						owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						owner = { has_monthly_income = { resource = energy value > 50 }}
						
					}
					add_building = building_research_lab_1
					owner = { add_resource = { minerals = -500 } }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough room : Adding building_research_lab_1 on planet [This.GetName] for [Owner.GetName]" }							
					add_modifier = { modifier = hc_building_added days = 360 }				
				}
				if = {
					limit = {
						not = { has_modifier = hc_building_added }						
						or = {
							is_homeworld = yes
							is_capital = yes
						}
						free_building_slots > 2
						free_jobs < 3
						num_pops > 50
						owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						owner = { has_monthly_income = { resource = energy value > 50 }}
						
					}
					add_building = building_research_lab_1
					owner = { add_resource = { minerals = -500 } }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : Enough room : Adding building_research_lab_1 on planet [This.GetName] for [Owner.GetName]" }							
					add_modifier = { modifier = hc_building_added days = 360 }				
				}				





				# Last resort
				if = {
					limit = {
						num_pops > 56
						free_building_slots > 0
						free_housing < 4
						owner = {
							or = {
								and = {
									has_monthly_income = {
										resource = food
										value < 0
									}
									resource_stockpile_compare = {
										resource = food
										value < 250
									}
								}
								and = {
									has_monthly_income = {
										resource = consumer_goods
										value < 0
									}
									resource_stockpile_compare = {
										resource = consumer_goods
										value < 250
									}
								}
							}
						}
					}
					random_owned_pop = {
						limit = {
							not = { has_job = technician }
							not = { has_job = miner }
							not = { has_job = farmer }
							not = { has_job = artisan }
						}
						kill_pop = yes
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :E : food & goods crisis : WARNING : killing Pop on planet [This.GetName] for [Owner.GetName]" }	
					}
				}
				
				###Calvitix Ressource Exchange
				if = {
					limit = {
						owner = {
						has_resource = { type = minerals amount > 20000 }
						has_resource = { type = alloys amount < 5000 }
						}
					}
					owner = {
					add_resource = { alloys = 250 }
					add_resource = { minerals = -5000 }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Empire :  +250 alloys, - 5000 minerals for [This.GetName]" }	
					
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount > 20000 }
						has_resource = { type = energy amount < 5000 }
						}
					}
					owner = {
					add_resource = { energy = 2500 }
					add_resource = { food = -5000 }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Empire :  +2500 energy , -5000 food for [This.GetName]" }	
					
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = consumer_goods amount > 15000 }
						has_resource = { type = energy amount < 5000 }
						}
					}
					owner = {
					add_resource = { energy = 5000 }
					add_resource = { consumer_goods = -5000 }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Empire :  +5000 energy, -5000 goods for [This.GetName]" }	
					
					}
				}
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount < 1000 }
						has_monthly_income = { resource = food value < 0 }						
						has_resource = { type = alloys amount > 30000 }
						has_monthly_income = { resource = alloys value > 30 }						
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Empire :  -5000 alloys, +3000 food for [This.GetName]" }	
					add_resource = { food = 3000 }
					add_resource = { alloys = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount < 1000 }
						has_monthly_income = { resource = food value < 0 }						
						has_resource = { type = energy amount > 30000 }
						has_monthly_income = { resource = energy value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Empire :  -5000 energy, +1000 food for [This.GetName]" }	
					add_resource = { food = 1000 }
					add_resource = { energy = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = energy amount < 5000 }
						has_monthly_income = { resource = energy value < 0 }						
						has_resource = { type = alloys amount > 30000 }
						has_monthly_income = { resource = alloys value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Empire :  +5000 energy, -1000 alloys for [This.GetName]" }	
					add_resource = { alloys = 1000 }
					add_resource = { energy = 5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = volatile_motes amount < 100 }
						has_monthly_income = { resource = volatile_motes value < 3 }						
						has_resource = { type = energy amount > 20000 }
						has_monthly_income = { resource = energy value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Empire :  -5000 energy, +300 volatile_motes for [This.GetName]" }	
					add_resource = { volatile_motes = 300 }
					add_resource = { energy = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = volatile_motes amount < 100 }
						has_monthly_income = { resource = volatile_motes value < 3 }						
						has_resource = { type = alloys amount > 15000 }
						has_monthly_income = { resource = alloys value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Empire :  -1000 alloys, +300 volatile_motes for [This.GetName]" }	
					add_resource = { volatile_motes = 300 }
					add_resource = { alloys = -1000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = exotic_gases amount < 100 }
						has_monthly_income = { resource = exotic_gases value < 3 }						
						has_resource = { type = energy amount > 20000 }
						has_monthly_income = { resource = energy value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Empire :  -5000 energy, +300 exotic_gases for [This.GetName]" }	
					add_resource = { exotic_gases = 300 }
					add_resource = { energy = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = exotic_gases amount < 100 }
						has_monthly_income = { resource = exotic_gases value < 3 }						
						has_resource = { type = alloys amount > 15000 }
						has_monthly_income = { resource = alloys value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Empire :  -1000 alloys, +300 exotic_gases for [This.GetName]" }	
					add_resource = { exotic_gases = 300 }
					add_resource = { alloys = -1000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = rare_crystals amount < 100 }
						has_monthly_income = { resource = rare_crystals value < 3 }						
						has_resource = { type = energy amount > 20000 }
						has_monthly_income = { resource = energy value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Empire :  -5000 energy, +300 rare_crystals for [This.GetName]" }	
					add_resource = { rare_crystals = 300 }
					add_resource = { energy = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = rare_crystals amount < 100 }
						has_monthly_income = { resource = rare_crystals value < 3 }						
						has_resource = { type = alloys amount > 15000 }
						has_monthly_income = { resource = alloys value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Empire :  -1000 alloys, +300 rare_crystals for [This.GetName]" }	
					add_resource = { rare_crystals = 300 }
					add_resource = { alloys = -1000 }
					}
				}			

				#High Level Stockpiles
				if = {
					limit = {
						owner = {
						has_resource = { type = consumer_goods amount > 80000 }
						has_monthly_income = { resource = consumer_goods value > 150 }						
						has_resource = { type = alloys amount < 50000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade H.level : Empire :  -20000 consumer_goods, + 5000 alloys for [This.GetName]" }	
					add_resource = { consumer_goods = -20000 }
					add_resource = { alloys = 5000 }
					}
				}			
				#High Level Stockpiles
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount > 80000 }
						has_monthly_income = { resource = food value > 150 }						
						has_resource = { type = alloys amount < 50000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade H.level : Empire :  -20000 food, + 5000 alloys for [This.GetName]" }	
					add_resource = { food = -20000 }
					add_resource = { alloys = 5000 }
					}
				}			
				#High Level Stockpiles
				if = {
					limit = {
						owner = {
						has_resource = { type = consumer_goods amount > 80000 }
						has_monthly_income = { resource = consumer_goods value > 150 }						
						has_resource = { type = energy amount < 50000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade H.level : Empire :  -20000 consumer_goods, + 10000  energy for [This.GetName]" }	
					add_resource = { consumer_goods = -20000 }
					add_resource = { energy = 10000 }
					}
				}			
				#High Level Stockpiles
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount > 80000 }
						has_monthly_income = { resource = food value > 150 }						
						has_resource = { type = energy amount < 50000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade H.level : Empire :  -20000 food, + 15000  energy for [This.GetName]" }	
					add_resource = { food = -20000 }
					add_resource = { energy = 15000 }
					}
				}	

				
			}	


			#Calvitix SuperBonus (When I.A. no more ressource has)
			if = {
				limit = {
					owner = {
						or = {
							and = {
							has_resource = { type = energy amount < 500 }
							has_resource = { type = minerals amount < 200 }
							has_resource = { type = food amount < 200 }
							has_monthly_income = { resource = minerals value < 2 }
							has_monthly_income = { resource = energy value < 2 }
							has_monthly_income = { resource = food value < 2 }
							}
							and = {
							has_resource = { type = energy amount < 50 }
							has_resource = { type = alloys amount < 20 }
							has_resource = { type = food amount < 20 }
							has_monthly_income = { resource = alloys value < 0 }
							has_monthly_income = { resource = food value < 0 }
							has_monthly_income = { resource = energy value < 0 }
							}
						}
					}
				}
				owner = {
					add_resource = { energy = 10000 }
					add_resource = { consumer_goods = 10000 }
					add_resource = { minerals = 10000 }
					add_resource = { food = 10000 }
					add_resource = { alloys = 1000 }
					add_modifier = { modifier = hc_god_hand days = 600 }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Empire : Hand of God +10000 Superbonus for [This.GetName]" }						
				}
			}				
		}
		### Gestalt Empires
		every_country = {
			limit = {
				is_ai = yes
				is_regular_empire = no
				is_gestalt = yes
				not = { is_country_type = primitive }
				not = { is_country_type = fallen_empire }
				not = { is_country_type = awakened_fallen_empire }
				not = { is_country_type = enclave }
				not = { is_country_type = nomad }
				not = { is_country_type = dormant_marauders }
				not = { is_country_type = awakened_marauders }
			}
			random_owned_planet = {
				limit = {
					is_colony = yes
					num_pops > 4
					not = { has_planet_flag = pf_health_checked }
					is_under_colonization = no
				}
				#log = "H: EDAI Check for planet [This.GetName]"	
				random_list = {
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 270
						}
						add_modifier = {
							modifier = health_checking
							days = 270
						}
					}
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 360
						}
						add_modifier = {
							modifier = health_checking
							days = 360
						}
					}
					30 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 180
						}
						add_modifier = {
							modifier = health_checking
							days = 180
						}
					}
					10 = {
						set_timed_planet_flag = {
							flag = pf_health_checked
							days = 90
						}
						add_modifier = {
							modifier = health_checking
							days = 90
						}
					}
				}
				
				# Early energy crisis
				if = {
					limit = {
						owner = { has_monthly_income = { resource = energy value < -20 }}
						#owner = { has_monthly_income = { resource = alloys value > 20 }}						
						#has_building = building_foundry_1
						free_jobs < 5
					}					
					if = {
						limit = {
							owner = { has_origin = origin_gas_giant }
							num_free_districts = { type = district_giga_planet_wind value > 0 }
						}
						add_district = district_giga_planet_wind
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Energy crisis < -20 : adding district_giga_planet_wind on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					else_if = {
						limit = {
							owner = { has_origin = origin_gas_giant }
							num_free_districts = { type = district_giga_planet_solar value > 0 }
						}
						add_district = district_giga_planet_solar
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Energy crisis < -20 : adding district_giga_planet_solar on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					else_if = {
						limit = {
							owner = { has_origin = origin_gas_giant }
							num_free_districts = { type = district_giga_planet_geothermal value > 0 }
						}
						add_district = district_giga_planet_geothermal
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Energy crisis < -20 : adding district_giga_planet_geothermal on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					else_if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator value > 0 }
						}
						add_district = district_generator
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Energy crisis < -20 : adding district_generator on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					else_if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator_uncapped value > 0 }
						}
						add_district = district_generator_uncapped
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Energy crisis < -20 : adding district_generator_uncapped on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_generator value > 0 }
						}
						add_district = district_rw_generator
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Energy crisis < -20 : adding district_rw_generator on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = habitat
							num_free_districts = { type = district_hab_energy value > 0 }
						}
						add_district = district_hab_energy
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Energy crisis < -20 : adding district_hab_generator on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						#remove_building = building_foundry_1
					}
					if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							#free_housing > 0
							or = {
								free_jobs < 10
								num_unemployed > 0

								}
							free_building_slots > 1
						}
						add_building = eb_energy #energy
						#owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Energy Crisis + Building : Adding building eb_energy on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }		
					}
					
				}
				if = {
					limit = {
						free_jobs < 5
						owner = { has_monthly_income = { resource = energy value < 1 }}
						owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						#owner = { has_monthly_income = { resource = consumer_goods value > 10 }}						
						#has_building = building_factory_1
					}
					if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator value > 0 }
						}
						add_district = district_generator
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Energy crisis < 1 : adding district_generator on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}
					else_if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_generator_uncapped value > 0 }
						}
						add_district = district_generator_uncapped
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Energy crisis < 1 : adding district_generator_uncapped on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_generator value > 0 }
						}
						add_district = district_rw_generator
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Energy crisis < 1 : adding district_rw_generator on planet [This.GetName] for [Owner.GetName]" }	
						#remove_building = building_factory_1
						add_modifier = { modifier = hc_generator_added days = 360 }										
						
					}	
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = habitat
							num_free_districts = { type = district_hab_energy value > 0 }
						}
						add_district = district_hab_energy
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Energy crisis < 1 : adding district_hab_generator on planet [This.GetName] for [Owner.GetName]" }	
						#remove_building = building_factory_1
						add_modifier = { modifier = hc_generator_added days = 360 }																
					}						
				}


				# Early minerals crisis
				# Make artisans and metallurgists into miners
				if = {
					limit = {
						free_jobs < 5						
						owner = { has_monthly_income = { resource = minerals value < 1 }}
						#owner = { has_monthly_income = { resource = alloys value > 10 }}						
						num_districts = { type = district_industrial value > 1 }
					}
					if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							num_free_districts = { type = district_mining value > 0 }
						}
						add_district = district_mining
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: minerals crisis : adding district_mining, removing district_industrial on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_mining_added days = 360 }				
						remove_district = district_industrial
						#remove_building = building_foundry_1
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							num_free_districts = { type = district_mining_uncapped value > 0 }
						}
						add_district = district_mining_uncapped
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: minerals crisis : adding district_mining_uncapped, removing district_industrial on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_mining_added days = 360 }				
						remove_district = district_industrial
						#remove_building = building_foundry_1
					}					
				}
				
				# Early CGs crisis
				# Make researchers into artisans
				if = {
					limit = {
						owner = { has_monthly_income = { resource = alloys value < 0 }}
						owner = { has_monthly_income = { resource = minerals value > 50 }}
						owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						#has_building = building_research_lab_1
						num_free_districts = { type = district_industrial value > 0 }

					}
					#remove_building = building_research_lab_1
					add_district = district_industrial
					owner = { add_resource = { minerals = -500 } }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: alloys crisis : adding district_industrial on planet [This.GetName] for [Owner.GetName]" }	
					add_modifier = { modifier = hc_industrial_added days = 360 }				
				}
				
				###Pollution
				#log = "H: before pollution for [This.GetName]" 					
				if = {
					limit = {
						or = {
							free_jobs < 5
							num_unemployed > 0

							has_modifier = eco_catastrophic
							has_modifier = eco_waste_high
						}
						or = { 
							has_modifier = eco_heavy
							has_modifier = eco_extreme
							has_modifier = eco_catastrophic
							has_modifier = eco_waste_mod
							has_modifier = eco_waste_high
						}
						owner = { has_monthly_income = { resource = energy value > 0 }}
					}
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Need cleaning pollution on planet [This.GetName] for [Owner.GetName]" }					
					if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
							free_building_slots > 0
						}
						add_building = eco_building_waste_recovery
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployement + Pollution : Adding eco_building_waste_recovery on planet [This.GetName] for [Owner.GetName]" }					
						add_modifier = { modifier = hc_building_added days = 360 }				
						
					}
				}



				# Crime and Instability
				if = {
					limit = {
						or = {
							planet_crime > 20
							and = {
								planet_crime > 10
								planet_stability < 50
							}
						}
						not = { has_building = building_sentinel_posts }
					}
					if = {
						limit = { 
							not = { has_modifier = hc_building_added }						
							free_building_slots > 0
							free_jobs < 1
						}
						add_building = building_sentinel_posts
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Crime crisis : adding building_sentinel_posts on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }				
					}
					else_if = {
						limit = { 
							has_building = building_maintenance_depot 
							not = { has_modifier = hc_building_added }						
							}
						remove_building = building_maintenance_depot
						add_building = building_sentinel_posts
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Crime crisis : adding building_sentinel_posts, remove maintenance_depot on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }				
					}
					else_if = {
						limit = { 
							has_building = building_research_lab_1 
							not = { has_modifier = hc_building_added }						
						}
						remove_building = building_research_lab_1
						add_building = building_sentinel_posts
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Crime crisis : adding building_sentinel_posts, remove research_lab on planet [This.GetName] for [Owner.GetName]" }							
						add_modifier = { modifier = hc_building_added days = 360 }				
					}
					else_if = {
						limit = { 
							not = { has_modifier = hc_building_added }						
							#has_building = building_foundry_1 
							free_building_slots > 0
							#owner = { has_monthly_income = { resource = alloys value > 10 }}	
						}
						#remove_building = building_foundry_1
						add_building = building_sentinel_posts
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Crime crisis : adding building_sentinel_posts on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }				
					}					
				}
				
				# Amenities
				if = {
					limit = {
						or = {
							free_amenities < 1
							and = {
								free_amenities < 5
								planet_stability < 25
							}
						}
						not = { has_building = building_maintenance_depot }						
					}
					if = {
						limit = { 
							not = { has_modifier = hc_building_added }						
							free_building_slots > 0
							free_jobs < 1
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}						
						}
						add_building = building_maintenance_depot
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: low Services : adding building_maintenance_depot on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }				
					}
					else_if = {
						limit = { 
							not = { has_modifier = hc_building_added }						
							has_building = building_research_lab_1 
						}
						remove_building = building_research_lab_1
						add_building = building_maintenance_depot						
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: low Services : adding building_maintenance_depot, remove research_building on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }				
					}
					else_if = {
						limit = { 
							not = { has_modifier = hc_building_added }						
							free_building_slots > 0
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}						
							#has_building = building_foundry_1 
							#owner = { has_monthly_income = { resource = alloys value > 10 }}	
						}
						#remove_building = building_foundry_1
						add_building = building_maintenance_depot
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: low Services : adding building_maintenance_depot on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }				
					}					
				}
				
				# Create More Jobs
				if = {
					limit = {
						or = {
							and = {
								free_jobs < 2
								free_building_slots > 1
							}
							and = {
								free_jobs < 3
								free_building_slots > 2
							}
							and = {
								num_pops > 40
								free_jobs < 1
								free_district_slots < 3
								free_building_slots > 0
								has_building_construction = no
							}
							and = {
								num_pops > 50
								free_jobs < 1
								free_district_slots < 1
								free_building_slots > 0
								has_building_construction = no
							}
						}
					}
					if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							num_buildings = { type = building_spawning_pool value < 5 }							
							free_building_slots > 1 
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						}
						add_building = building_spawning_pool				
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Enough Room : adding building_spawning_pool on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }				
					}
					else_if = {
						limit = {
							#num_buildings = { type = building_foundry_1 value < 4 }
							num_free_districts = { type = district_industrial value > 0 }
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							owner = { has_monthly_income = { resource = alloys value < 20 }}
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
							
						}
						add_district = district_industrial
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Enough Room & low alloy: adding district_industrial on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_industrial_added days = 360 }				
					}
					else_if = {
						limit = {
							num_free_districts = { type = district_industrial value > 0 }
							owner = { has_monthly_income = { resource = minerals value > 50 }}
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
							owner = { has_monthly_income = { resource = consumer_goods value < 10 }}
						}
						add_district = district_industrial
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Enough Room & low good: adding district_industrial on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_industrial_added days = 360 }				
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							not = { has_building = building_research_lab_1 }
							free_building_slots > 1
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						}
						add_building = building_research_lab_1					
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Enough Room : adding building_research_lab_1 on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }				
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_building_added }						
							not = { has_building = building_maintenance_depot free_building_slots > 1}
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						}
						add_building = building_maintenance_depot				
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Enough Room : adding building_maintenance_depot on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }				
					}
					else_if = {
						limit = { 
							not = { has_modifier = hc_building_added }						
							free_building_slots > 0 
							num_buildings = { type = building_spawning_pool value < 5 }							
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						}
						add_building = building_spawning_pool
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Enough Room : adding building_spawning_pool on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_building_added days = 360 }				
					}
				}
				
				# Unemployment
				if = {
					limit = { any_owned_pop = { is_unemployed = yes }}
					if = {
						limit = { 
							owner = { has_monthly_income = { resource = energy value < 50 }}
							owner = { has_monthly_income = { resource = food value > -2 }}							
							owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						}
						if = {
							limit = {
								num_free_districts = { type = district_generator value > 0 }
							}
							add_district = district_generator
							owner = { add_resource = { minerals = -500 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment & low Energy : adding district_generator on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_generator_added days = 360 }				
						}
						else_if = {
							limit = {
								num_free_districts = { type = district_generator_uncapped value > 0 }
							}
							add_district = district_generator_uncapped
							owner = { add_resource = { minerals = -500 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment & low Energy : adding district_generator_uncapped on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_generator_added days = 360 }				
						}						
						else_if = {
							limit = {
								num_free_districts = { type = district_rw_generator value > 0 }
							}
							add_district = district_rw_generator
							owner = { add_resource = { minerals = -500 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment & low Energy : adding district_rw_generator on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_generator_added days = 360 }				
						}
						else_if = {
							limit = {
								num_free_districts = { type = district_hab_energy value > 0 }
							}
							add_district = district_hab_energy
							owner = { add_resource = { minerals = -500 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment & low Energy : adding district_hab_generator on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_generator_added days = 360 }				
						}						
					}
					else_if = {
						limit = { 
							owner = { has_monthly_income = { resource = food value < 10 }}
							owner = { resource_stockpile_compare = { resource = food value < 1000 } }														
							owner = { resource_stockpile_compare = { resource = minerals value > 500 }}
						}
						if = {
							limit = {
								not = { has_modifier = hc_farming_added }						
								num_free_districts = { type = district_farming value > 0 }
							}
							add_district = district_farming
							owner = { add_resource = { minerals = -300 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment & low food : adding district_farming on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_farming_added days = 360 }				
						}
						else_if = {
							limit = {
								not = { has_modifier = hc_farming_added }						
								num_free_districts = { type = district_farming_uncapped value > 0 }
							}
							add_district = district_farming_uncapped
							owner = { add_resource = { minerals = -300 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment & low food : adding district_farming_uncapped on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_farming_added days = 360 }				
						}
						else_if = {
							limit = {
								not = { has_modifier = hc_farming_added }						
								num_free_districts = { type = district_rw_farming value > 0 }
							}
							add_district = district_rw_farming
							owner = { add_resource = { minerals = -300 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment & low food : adding district_rw_farming on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_farming_added days = 360 }				
							
						}
						else_if = {
							limit = {
								not = { has_modifier = hc_farming_added }						
								free_building_slots > 1
							}
							add_building = building_hydroponics_farm
							owner = { add_resource = { minerals = -300 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployement + Low food : Adding building_hydroponics_farm on planet [This.GetName] for [Owner.GetName]" }					
							add_modifier = { modifier = hc_farming_added days = 360 }				
							
						}					
						
						
					}
					else_if = {
						limit = { 
							owner = { has_monthly_income = { resource = minerals value < 75 }}
						}
						if = {
							limit = {
								not = { has_modifier = hc_mining_added }						
								num_free_districts = { type = district_mining value > 0 }
							}
							add_district = district_mining
							owner = { add_resource = { minerals = -300 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment & low minerals : adding district_mining on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_mining_added days = 360 }				
							
						}
						else_if = {
							limit = {
								not = { has_modifier = hc_mining_added }						
								num_free_districts = { type = district_mining_uncapped value > 0 }
							}
							add_district = district_mining_uncapped
							owner = { add_resource = { minerals = -300 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment & low minerals : adding district_mining_uncapped on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_mining_added days = 360 }				
							
						}						
					}
					else_if = {
						limit = { free_building_slots > 1 }
						if = {
							limit = {
								free_district_slots > 0
								num_free_districts = { type = district_industrial value > 0 }
								owner = { has_monthly_income = { resource = minerals value > 50 }}
								owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
								owner = { has_monthly_income = { resource = alloys value < 20 }}
							}
							add_district = district_industrial
							owner = { add_resource = { minerals = -500 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment & low alloys : adding district_industrial on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_industrial_added days = 360 }				
						}
						else_if = {
							limit = { 
								free_district_slots > 0
								num_free_districts = { type = district_industrial value > 0 }
								owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
								owner = { has_monthly_income = { resource = consumer_goods value < 25 }}
							}
							add_district = district_industrial
							owner = { add_resource = { minerals = -500 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment & low goods : adding district_industrial on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_industrial_added days = 360 }				
						}
						else_if = {
							limit = { 
								not = { has_modifier = hc_building_added }						
								num_buildings = { type = building_research_lab_1 value < 4 }
								owner = { has_monthly_income = { resource = energy value > 20 }}
								owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
							}
							add_building = building_research_lab_1					
							owner = { add_resource = { minerals = -500 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment  : adding research_lab on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_building_added days = 360 }				
						}
						else_if = {
							limit = {
								not = { has_modifier = hc_building_added }						
								num_buildings = { type = building_maintenance_depot value < 3 }
								free_amenities < 10
								owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
							}
							add_building = building_maintenance_depot				
							owner = { add_resource = { minerals = -500 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment  : adding building_maintenance_depot on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_building_added days = 360 }				
						}
						else_if = { 
							limit = {
							not = { has_modifier = hc_building_added }						
								num_buildings = { type = building_spawning_pool value < 5 }
								owner = { resource_stockpile_compare = { resource = minerals value > 800 }}								
							}							
							add_building = building_spawning_pool
							owner = { add_resource = { minerals = -500 } }
							if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment  : adding building_spawning_pool on planet [This.GetName] for [Owner.GetName]" }	
							add_modifier = { modifier = hc_building_added days = 360 }				
						}
					}
				}
				
				
				# Calvitix Zone Commerc Vs Foundry
				if = {
					limit = {
						free_district_slots > 0
						or = {
							free_jobs < 5
							any_owned_pop = { is_unemployed = yes }
						}
						#free_amenities > 20
						owner = { has_monthly_income = { resource = alloys value < 20 }}						
						owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						owner = { has_monthly_income = { resource = minerals value > 50 }}						
						num_free_districts = { type = district_industrial value > 0 }
						
					}
					#remove_building = building_commercial_zone
					add_district = district_industrial
					owner = { add_resource = { minerals = -500 } }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Unemployment  : adding district_industrial on planet [This.GetName] for [Owner.GetName]" }						
					add_modifier = { modifier = hc_industrial_added days = 360 }				
				}
				
				
				
				# Uncleared blockers - just get rid of them
				if = {
					limit = { free_district_slots < 2 }
					clear_blockers = yes
				}
				
				# Economic Fine Tuning - surplus is wasting space
				if = {
					limit = {
						free_housing > 4
						free_jobs > 3
						free_district_slots < 5
						not = { any_owned_pop = { is_unemployed = yes }}
					}
					if = {
						limit = {
							has_district = district_farming
							owner = {
								has_monthly_income = {
									resource = food
									value > 50
								}
								resource_stockpile_compare = {
									resource = food
									value > 5000
								}
							}
						}
						remove_district = district_farming
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Enough food : removing district_farming on planet [This.GetName] for [Owner.GetName]" }							
						
					}
				}
				if = {
					limit = {
						free_housing > 3
						free_jobs > 3
						free_district_slots < 2
						not = { any_owned_pop = { is_unemployed = yes }}
					}
					if = {
						limit = {
							has_district = district_mining
							owner = {
								has_monthly_income = {
									resource = minerals
									value > 500
								}
								resource_stockpile_compare = {
									resource = minerals
									value > 12000
								}
							}
						}
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Enough minerals : removing district_mining on planet [This.GetName] for [Owner.GetName]" }							
					}
				}
				if = {
					limit = {
						free_housing > 3
						free_jobs > 3
						free_district_slots < 2
						not = { any_owned_pop = { is_unemployed = yes }}
					}
					if = {
						limit = {
							has_district = district_generator
							owner = {
								has_monthly_income = {
									resource = energy
									value > 250
								}
								resource_stockpile_compare = {
									resource = energy
									value > 10000
								}
							}
						}
						remove_district = district_generator
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Enough food : removing district_generator on planet [This.GetName] for [Owner.GetName]" }							
						
					}
				}
				
				# Housing
				if = {
					limit = {
						free_housing < 1
					}
					if = {
						limit = {
							free_district_slots > 0
							not = { uses_district_set = ring_world }
							num_free_districts = { type = district_hive value > 0 }
						}
						add_district = district_hive
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: need housing : adding district_hive on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_city_added days = 360 }				
					}
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_hive value > 0 }
						}
						add_district = district_rw_hive
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: need housing : adding district_rw_hive on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_city_added days = 360 }				
					}
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = habitat
							num_free_districts = { type = district_hab_housing value > 0 }
						}
						add_district = district_hab_housing
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: need housing : adding district_hab_housing on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_city_added days = 360 }				
					}					
					else_if = {
						limit = {
							free_district_slots > 0
							uses_district_set = ring_world
							num_free_districts = { type = district_rw_nexus value > 0 }
						}
						add_district = district_rw_nexus
						owner = { add_resource = { minerals = -500 } }
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: need housing : adding district_rw_nexus for [This.GetName] NOT SUPPOSED TO HAPPEN" }	
						add_modifier = { modifier = hc_city_added days = 360 }				
					}

				}
				else_if = {
					limit = { free_housing < -1 }
					clear_blockers = yes
				}
				
				# Overcrowding - pointless unemployed homeless pops lags up the game
				if = {
					limit = {
						any_owned_pop = { is_unemployed = yes }
						free_building_slots < 1
						free_district_slots < 1
						num_pops > 82
						free_housing < 0
					}
					random_owned_pop = {
						limit = { is_unemployed = yes }
						kill_pop = yes
					}
					random_owned_pop = {
						limit = { is_unemployed = yes }
						kill_pop = yes
					}
					random_owned_pop = {
						limit = { is_unemployed = yes }
						kill_pop = yes
					}
				}
				
				# Surplus getting in the way
				if = {
					limit = {
						free_housing > 50 #30
						num_districts = { type = district_hive value > 0 }
						free_jobs > 2
						free_building_slots > 4						
					}
					remove_district = district_hive
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Enough Housing > 50 : removing district_hive on planet [This.GetName] for [Owner.GetName]" }												
				}
				if = {
					limit = {
						has_building = building_maintenance_depot
						free_jobs > 4
						free_amenities > 25
						owner = {
							has_monthly_income = {
								resource = energy
								value > 150
							}
							has_monthly_income = {
								resource = consumer_goods
								value > 75
							}
						}
					}
					remove_building = building_maintenance_depot
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Enough Amenities : removing building_maintenance_depot on planet [This.GetName] for [Owner.GetName]" }							
					
				}
				
				# Shortages rectified by removing surplus
				# Make workers change jobs
				if = {
					limit = {
						not = { has_modifier = hc_farming_added }						
						num_districts = { type = district_mining value > 0 }
						num_free_districts = { type = district_farming value > 0 }
						owner = {
							has_monthly_income = { resource = minerals value > 80 }
							resource_stockpile_compare = { resource = minerals value > 1000 }
							has_monthly_income = { resource = food value < 2 }
						}
					}
					remove_district = district_mining
					add_district = district_farming
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: low food : adding district_farming, removing district_mining on planet [This.GetName] for [Owner.GetName]" }	
					add_modifier = { modifier = hc_farming_added days = 360 }				
					
				}						
				if = {
					limit = {
						has_district = district_generator
						num_free_districts = { type = district_farming value > 0 }
						owner = {
							has_monthly_income = {
								resource = energy
								value > 100
							}
							resource_stockpile_compare = {
								resource = energy
								value > 2000
							}
							has_monthly_income = {
								resource = food
								value < 2
							}
						}
					}
					remove_district = district_generator
					add_district = district_farming
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: low food : adding district_farming, removing district_generator on planet [This.GetName] for [Owner.GetName]" }	
					add_modifier = { modifier = hc_farming_added days = 360 }				
					
				}
				if = {
					limit = {
						has_district = district_farming
						num_free_districts = { type = district_generator value > 0 }
						owner = {
							has_monthly_income = {
								resource = energy
								value < 2
							}
							resource_stockpile_compare = {
								resource = energy
								value < 1000
							}
							has_monthly_income = {
								resource = food
								value > 50
							}
							resource_stockpile_compare = {
								resource = food
								value > 2000
							}
						}
					}
					remove_district = district_farming
					add_district = district_generator
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: low energy : adding district_generator, removing district_farming on planet [This.GetName] for [Owner.GetName]" }	
					add_modifier = { modifier = hc_generator_added days = 360 }				
					
				}
				
				# Minerals shortages are rare
				if = {
					limit = {
						free_jobs < 4
						num_pops > 25
						or = {
							owner = { has_monthly_income = { resource = minerals value < 1 }}
							and = {
								owner = { has_monthly_income = { resource = minerals value < 20 }}
								owner = { resource_stockpile_compare = { resource = minerals value < 1000 }}
							}
						}
					}
					if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							num_free_districts = { type = district_mining value > 0 }
						}
						add_district = district_mining
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: low minerals : adding district_mining,  on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_mining_added days = 360 }
					}
					else_if = {
						limit = {
							not = { has_modifier = hc_mining_added }						
							num_free_districts = { type = district_mining_uncapped value > 0 }
						}
						add_district = district_mining_uncapped
						if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: low minerals : adding district_mining_uncapped,  on planet [This.GetName] for [Owner.GetName]" }	
						add_modifier = { modifier = hc_mining_added days = 360 }
					}					
				}

				# Homeworld with too many empty building slots			
				if = {
					limit = {
						not = { has_modifier = hc_building_added }						
						or = {
							is_homeworld = yes
							is_capital = yes
						}
						free_building_slots > 4
						free_jobs < 3
						num_pops > 40
						owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						owner = { has_monthly_income = { resource = energy value > 30 }}
						
					}
					add_building = building_research_lab_1
					owner = { add_resource = { minerals = -500 } }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Enough room : adding building_research_lab_1,  on planet [This.GetName] for [Owner.GetName]" }	
					add_modifier = { modifier = hc_building_added days = 360 }
				}				
				if = {
					limit = {
						or = {
							is_homeworld = yes
							is_capital = yes
						}
						free_building_slots > 3
						free_jobs < 3
						num_pops > 45
						owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						owner = { has_monthly_income = { resource = energy value > 50 }}
					}
					add_building = building_research_lab_1
					owner = { add_resource = { minerals = -500 } }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Enough room : adding building_research_lab_1,  on planet [This.GetName] for [Owner.GetName]" }	
					add_modifier = { modifier = hc_building_added days = 360 }
				}
				if = {
					limit = {
						or = {
							is_homeworld = yes
							is_capital = yes
						}
						free_building_slots > 2
						free_jobs < 3
						num_pops > 50
						owner = { resource_stockpile_compare = { resource = minerals value > 800 }}
						owner = { has_monthly_income = { resource = energy value > 50 }}
					}
					add_building = building_research_lab_1
					owner = { add_resource = { minerals = -500 } }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI :H: Enough room : adding building_research_lab_1,  on planet [This.GetName] for [Owner.GetName]" }	
					add_modifier = { modifier = hc_building_added days = 360 }
				}				





				# Last resort
				if = {
					limit = {
						num_pops > 36
						free_building_slots > 0
						free_housing < 4
						owner = {
							or = {
								and = {
									has_monthly_income = {
										resource = food
										value < 0
									}
									resource_stockpile_compare = {
										resource = food
										value < 250
									}
								}
								and = {
									has_monthly_income = {
										resource = consumer_goods
										value < 0
									}
									resource_stockpile_compare = {
										resource = consumer_goods
										value < 250
									}
								}
							}
						}
					}
					random_owned_pop = {
						limit = {
							not = { has_job = technician_drone }
							not = { has_job = mining_drone }
							not = { has_job = agri_drone }
							not = { has_job = artisan_drone }
						}
						kill_pop = yes
					}
				}
				
				###Calvitix Ressource Exchange
				if = {
					limit = {
						owner = {
						has_resource = { type = minerals amount > 20000 }
						has_resource = { type = alloys amount < 5000 }
						}
					}
					owner = {
					add_resource = { alloys = 250 }
					add_resource = { minerals = -5000 }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Hive : alloys +250, -5000 minerals  for [This.GetName]" }	
					
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount > 20000 }
						has_resource = { type = energy amount < 5000 }
						}
					}
					owner = {
					add_resource = { energy = 2500 }
					add_resource = { food = -5000 }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Hive : energy +2500, -5000 food  for [This.GetName]" }	
					
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = consumer_goods amount > 15000 }
						has_resource = { type = energy amount < 5000 }
						}
					}
					owner = {
					add_resource = { energy = 5000 }
					add_resource = { consumer_goods = -5000 }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Hive : energy +250, -5000 goods  for [This.GetName]" }	
					
					}
				}
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount < 1000 }
						has_monthly_income = { resource = food value < 0 }						
						has_resource = { type = alloys amount > 30000 }
						has_monthly_income = { resource = alloys value > 30 }						
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Hive : -5000 alloys, +3000 food for [This.GetName]" }	
					add_resource = { food = 3000 }
					add_resource = { alloys = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount < 1000 }
						has_monthly_income = { resource = food value < 0 }						
						has_resource = { type = energy amount > 30000 }
						has_monthly_income = { resource = energy value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Hive :  -5000 energy, +1000 food for [This.GetName]" }	
					add_resource = { food = 1000 }
					add_resource = { energy = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = energy amount < 5000 }
						has_monthly_income = { resource = energy value < 0 }						
						has_resource = { type = alloys amount > 30000 }
						has_monthly_income = { resource = alloys value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Hive :  +5000 energy, -1000 alloys for [This.GetName]" }	
					add_resource = { alloys = 1000 }
					add_resource = { energy = 5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = volatile_motes amount < 100 }
						has_monthly_income = { resource = volatile_motes value < 3 }						
						has_resource = { type = energy amount > 20000 }
						has_monthly_income = { resource = energy value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Hive :  -5000 energy, +300 volatile_motes for [This.GetName]" }	
					add_resource = { volatile_motes = 300 }
					add_resource = { energy = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = volatile_motes amount < 100 }
						has_monthly_income = { resource = volatile_motes value < 3 }						
						has_resource = { type = alloys amount > 15000 }
						has_monthly_income = { resource = alloys value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Hive :  -1000 alloys, +300 volatile_motes for [This.GetName]" }	
					add_resource = { volatile_motes = 300 }
					add_resource = { alloys = -1000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = exotic_gases amount < 100 }
						has_monthly_income = { resource = exotic_gases value < 3 }						
						has_resource = { type = energy amount > 20000 }
						has_monthly_income = { resource = energy value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Hive :  -5000 energy, +300 exotic_gases for [This.GetName]" }	
					add_resource = { exotic_gases = 300 }
					add_resource = { energy = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = exotic_gases amount < 100 }
						has_monthly_income = { resource = exotic_gases value < 3 }						
						has_resource = { type = alloys amount > 15000 }
						has_monthly_income = { resource = alloys value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Hive :  -1000 alloys, +300 exotic_gases for [This.GetName]" }	
					add_resource = { exotic_gases = 300 }
					add_resource = { alloys = -1000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = rare_crystals amount < 100 }
						has_monthly_income = { resource = rare_crystals value < 3 }						
						has_resource = { type = energy amount > 20000 }
						has_monthly_income = { resource = energy value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Hive :  -5000 energy, +300 rare_crystals for [This.GetName]" }	
					add_resource = { rare_crystals = 300 }
					add_resource = { energy = -5000 }
					}
				}			
				if = {
					limit = {
						owner = {
						has_resource = { type = rare_crystals amount < 100 }
						has_monthly_income = { resource = rare_crystals value < 3 }						
						has_resource = { type = alloys amount > 15000 }
						has_monthly_income = { resource = alloys value > 30 }												
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Hive :  -1000 alloys, +300 rare_crystals for [This.GetName]" }	
					add_resource = { rare_crystals = 300 }
					add_resource = { alloys = -1000 }
					}
				}			

				#High Level Stockpiles
				if = {
					limit = {
						owner = {
						has_resource = { type = consumer_goods amount > 80000 }
						has_monthly_income = { resource = consumer_goods value > 150 }						
						has_resource = { type = alloys amount < 50000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade H.level : Hive :  -20000 consumer_goods, + 5000 alloys for [This.GetName]" }	
					add_resource = { consumer_goods = -20000 }
					add_resource = { alloys = 5000 }
					}
				}			
				#High Level Stockpiles
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount > 80000 }
						has_monthly_income = { resource = food value > 150 }						
						has_resource = { type = alloys amount < 50000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade H.level : Hive :  -20000 food, + 5000 alloys for [This.GetName]" }	
					add_resource = { food = -20000 }
					add_resource = { alloys = 5000 }
					}
				}			
				#High Level Stockpiles
				if = {
					limit = {
						owner = {
						has_resource = { type = consumer_goods amount > 80000 }
						has_monthly_income = { resource = consumer_goods value > 150 }						
						has_resource = { type = energy amount < 50000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade H.level : Hive :  -20000 consumer_goods, + 10000  energy for [This.GetName]" }	
					add_resource = { consumer_goods = -20000 }
					add_resource = { energy = 10000 }
					}
				}			
				#High Level Stockpiles
				if = {
					limit = {
						owner = {
						has_resource = { type = food amount > 80000 }
						has_monthly_income = { resource = food value > 150 }						
						has_resource = { type = energy amount < 50000 }
						}
					}
					owner = {
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade H.level : Hive :  -20000 food, + 15000  energy for [This.GetName]" }	
					add_resource = { food = -20000 }
					add_resource = { energy = 15000 }
					}
				}	
				
				
			}
			
			
			
			#Calvitix SuperBonus (When I.A. no more ressource has)
			if = {
				limit = {
					owner = {
					or = {
						and = {
						has_resource = { type = energy amount < 500 }
						has_resource = { type = minerals amount < 200 }
						has_resource = { type = food amount < 200 }
						has_monthly_income = { resource = minerals value < 2 }
						has_monthly_income = { resource = energy value < 2 }
						has_monthly_income = { resource = food value < 2 }
						}
						and = {
						has_resource = { type = energy amount < 50 }
						has_resource = { type = alloys amount < 20 }
						has_resource = { type = food amount < 20 }
						has_monthly_income = { resource = alloys value < 0 }
						has_monthly_income = { resource = food value < 0 }
						has_monthly_income = { resource = energy value < 0 }
						}
					}
					}
				}
				owner = {
					add_resource = { energy = 10000 }
					add_resource = { consumer_goods = 10000 }
					add_resource = { minerals = 10000 }
					add_resource = { food = 10000 }
					add_resource = { alloys = 1000 }
					add_modifier = { modifier = hc_god_hand days = 600 }
					if = { limit = { has_global_flag = edai_logging	} log = "EDAI Ressources Trade : Hive : Hand of God +10000 : Superbonus for [This.GetName]" }	
					
				}
			}				
		}
	}
}