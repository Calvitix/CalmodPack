############################
#
# On Action Events
#
# Written by Annatar
#
############################


namespace = newfrontiers_action

# Sets <planet_class>_surveyed country flag
ship_event = {
	id = newfrontiers_action.100
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {
		from = {
			OR = {
				has_modifier = scorched_world
				has_modifier = frozen_ocean
				has_modifier = ammonia_world
			}
		}
	}

	immediate = {
		if = {
			limit = {
				from = { has_modifier = scorched_world }
			}
			random_list = {
				4 = {
					from = {
						change_pc = { class = pc_desert }
						set_planet_entity = { 
							picture = pc_underground 
							entity = scorched_planet_01_entity
						}
						
						remove_subclass_modifiers = yes
						add_modifier = {
							modifier = underground_world
							days = -1
						}
						reroll_deposits = yes	
					}
					ship_event = { id = newfrontiers_action.1 }
				}
				96 = {
					#Null
				}
			}
			break = yes
		}
		if = {
			limit = {
				from = { has_modifier = frozen_ocean }
			}
			random_list = {
				3 = {
					from = {
						change_pc = { class = pc_arctic }
						set_planet_entity = { 
							picture = pc_cryokarst 
							entity = frozen_ocean_planet_01_entity
						}
						
						remove_subclass_modifiers = yes
						add_modifier = {
							modifier = cryokarst_world
							days = -1
						}
						reroll_deposits = yes	
					}
					ship_event = { id = newfrontiers_action.3 }
				}
				97 = {
					#Null
				}
			}
			break = yes
		}
		if = {
			limit = {
				from = { has_modifier = ammonia_world }
			}
			ship_event = { id = newfrontiers_action.4 }
			break = yes
		}
	}
}

### Underground World found!
ship_event = {
	id = newfrontiers_action.1
	title = "newfrontiers_action.1.name"
	desc = "newfrontiers_action.1.desc"
	picture = GFX_evt_infernal_world
	show_sound = event_scanner
	location = FROM
	
	is_triggered_only = yes

	trigger = {
		from = {
			has_planet_flag = infernal_world
		}
	}
	
	immediate = {
		from = {
			change_pc = { class = pc_hollow inherit_entity = yes }
			set_planet_entity = { 
				picture = pc_infernal
			}
			add_modifier = {
				modifier = infernal_world
				days = -1
			}
			reroll_deposits = yes
		}
		owner = { country_event = { id = story.5 days = 2 } }
	}

	option = {
		name = INCREDIBLE
	}
}

### Terraform finish
planet_event = {
	id = newfrontiers_action.2
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		THIS = {
			remove_subclass_modifiers = yes
			remove_condition_modifiers = yes
		}
	}

}

### Subglacial World found!
ship_event = {
	id = newfrontiers_action.3
	title = "newfrontiers_action.3.name"
	desc = "newfrontiers_action.3.desc"
	picture = GFX_evt_subglacial_world
	show_sound = event_scanner
	location = FROM
	
	is_triggered_only = yes

	trigger = {
		from = {
			has_planet_flag = subglacial_world
		}
	}
	
	immediate = {
		from = {
			change_pc = { class = pc_hollow inherit_entity = yes }
			set_planet_entity = { 
				picture = pc_subglacial
			}
			add_modifier = {
				modifier = subglacial_world
				days = -1
			}
			reroll_deposits = yes
		}
		owner = { country_event = { id = story.5 days = 2 } }
	}

	option = {
		name = INCREDIBLE
	}
}

### Ammonia Biosphere
ship_event = {
	id = newfrontiers_action.4
	title = "anomaly.690.name"
	desc = "newfrontiers_action.4.desc"
	picture = GFX_evt_ammonia_world
	show_sound = event_ship_bridge
	location = FROM
	
	is_triggered_only = yes

	trigger = {
		from = {
			has_modifier = ammonia_world
		}
	}

	immediate = {
		fromfrom = { clear_deposits = yes }
		owner = { country_event = { id = story.5 days = 2 } }
	}
	
	option = {
		name = FASCINATING
		FROMFROM = { 
			set_deposit = d_society_3
		}
	}
}

### Hollow World found!
ship_event = {
	id = newfrontiers_action.5
	title = "newfrontiers_action.5.name"
	desc = "newfrontiers_action.5.desc"
	picture = GFX_evt_hollow_world
	show_sound = event_scanner
	location = FROM
	
	is_triggered_only = yes
	
	trigger = {
		from = {
			has_planet_flag = hollow_world
		}
	}
	
	immediate = {
		from = {
			change_pc = { class = pc_hollow inherit_entity = yes }
			reroll_deposits = yes
		}
		owner = { country_event = { id = story.5 days = 2 } }
	}

	option = {
		name = INCREDIBLE
	}
}

