############################
#
# Expanded Leviathan Events
#
############################

namespace = leviathanexpanded

##################################
# Curator - Events and Anomalies
# Reserved 1 - 99
##################################

# Buy Clue from Curator
country_event = {
	id = leviathanexpanded.1
	title = leviathans.508.name
	desc = leviathanexpanded.1.desc
	
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
		event_target:curators = {
			owner_species = { save_event_target_as = curator_species }
		}
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathanexpanded.1.a
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
			hidden_trigger = {
				NOR = {
					has_completed_event_chain_counter = {
						event_chain = "ancient_observer_chain" 
						counter = "observer_clues_found" 
					}
					has_country_flag = bought_observer_curator_clue
				}
			}
		}
		add_resource = { energy = -1000 }
		custom_tooltip = opinion10
		add_observer_clue = yes
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 10
				}
			}
			set_country_flag = bought_observer_curator_clue
		}
	}
	option = {
		name = leviathanexpanded.1.b
		response_text = leviathanexpanded.1.b.response
		is_dialog_only = yes
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		custom_gui = "enclave_curator_option"
		default_hide_option = yes
	}
}

# Hatchling
# Curator Guardians Menu
country_event = {
	id = leviathanexpanded.2
	title = leviathanexpanded.2.name
	desc = leviathanexpanded.2.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathanexpanded.2.a
		response_text = leviathanexpanded.2.a.reply
		is_dialog_only = yes
		custom_gui = "enclave_curator_option"
	}
	option = {
		name = leviathanexpanded.2.b
		response_text = leviathanexpanded.2.b.reply
		trigger = {
			NOT = { has_modifier = curator_buff_hatchling_two }
		}
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
		}
		add_resource = { energy = -1000 }
		add_modifier = {
			modifier = curator_buff_hatchling_two
			days = -1
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
		}
	}
	option = { # Can we fight it? (No)
		name = leviathans.506.f
		trigger = { fleet_power < 5000	}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f1.reply
	}
	option = { # Can we fight it? (Probably not)
		name = leviathans.506.f
		trigger = {
			fleet_power > 5000
			fleet_power < 15000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f2.reply
	}
	option = { # Can we fight it? (Maybe)
		name = leviathans.506.f
		trigger = {
			fleet_power > 15000
			fleet_power < 30000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f3.reply
	}
	option = { # Can we fight it? (Yes)
		name = leviathans.506.f
		trigger = { fleet_power > 30000 }
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f4.reply
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
	}
}

##################################
# Curator - Services
# Reserved 100 - 199
##################################

# Buying Precursor Insights
country_event = {
	id = leviathanexpanded.101
	title = leviathanexpanded.101.name
	desc = {
		trigger = { has_event_chain = "cybrex_chain" }
		text = leviathanexpanded.101.desc.a
	}
	desc = {
		trigger = { has_event_chain = "first_league_chain" }
		text = leviathanexpanded.101.desc.b
	}
	desc = {
		trigger = { has_event_chain = "irassian_chain" }
		text = leviathanexpanded.101.desc.c
	}
	desc = {
		trigger = { has_event_chain = "yuht_chain" }
		text = leviathanexpanded.101.desc.d
	}
	desc = {
		trigger = { has_event_chain = "vultaum_chain" }
		text = leviathanexpanded.101.desc.e
	}
	
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
		event_target:curators = {
			owner_species = { save_event_target_as = curator_species }
		}
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = distar.11501.a
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 5000 }
			hidden_trigger = { have_active_precursor_chain = yes }
		}
		add_resource = { energy = -5000 }
		custom_tooltip = leviathanexpanded.101.a.tooltip
		custom_tooltip = opinion20
		hidden_effect = {
			country_event = { id = leviathanexpanded.102 }
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			random_list = {
				1 = {
					set_timed_country_flag = {
						flag = curator_precursor_purchased
						days = 9360 # 26 years
					}
				}
				1 = {
					set_timed_country_flag = {
						flag = curator_precursor_purchased
						days = 7200 # 20 years
					}
				}
				1 = {
					set_timed_country_flag = {
						flag = curator_precursor_purchased
						days = 5040 # 14 years
					}
				}
			}
		}
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		custom_gui = "enclave_curator_option"
		default_hide_option = yes
	}
}

country_event = {
	id = leviathanexpanded.102
	title = "precursor.301.name"
	desc = "leviathanexpanded.102.desc"
		
	picture = GFX_evt_archaeological_dig
	location = event_target:precursor_planet
	trackable = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_event_chain = "vultaum_chain"
				any_system_within_border = { 
					has_star_flag = precursor_1
				}
			}
			spawn_vultaum_anomaly = yes
			break = yes
		}
		if = {
			limit = {
				has_event_chain = "yuht_chain"
				any_system_within_border = { 
					has_star_flag = precursor_2
				}
			}
			spawn_yuht_anomaly = yes
			break = yes
		}
		if = {
			limit = {
				has_event_chain = "first_league_chain"
				any_system_within_border = { 
					has_star_flag = precursor_3
				}
			}
			spawn_league_anomaly = yes
			break = yes
		}
		if = {
			limit = {
				has_event_chain = "irassian_chain"
				any_system_within_border = { 
					has_star_flag = precursor_4
				}
			}
			spawn_irassian_anomaly = yes
			break = yes
		}
		if = {
			limit = {
				has_event_chain = "cybrex_chain"
				any_system_within_border = { 
					has_star_flag = precursor_5
				}
			}
			spawn_cybrex_anomaly = yes
			break = yes
		}
	}
	
	option = {
		name = precursor.301.a
		custom_tooltip = new_precursor_project
	}
}

##################################
# Shroudwalkers - Divinations
# Reserved 200 - 299
##################################

situation_event = {
	id = leviathanexpanded.200
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:friendly_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = friendly_divination_planet
			}
			any_planet_within_border = {
				habitable_planet = yes
				is_colony = no
				is_under_colonization = no
				NOR = {
					has_modifier = bleak_planet
					has_modifier = titanic_life
					#has_modifier = death_world
					has_modifier = young_world
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = friendly_situation
		owner = {
			set_country_flag = friendly_divination_planet
			random_planet_within_border = {
				limit = {
					habitable_planet = yes
					is_colony = no
					is_under_colonization = no
					NOR = {
						has_modifier = bleak_planet
						has_modifier = titanic_life
						#has_modifier = death_world
						has_modifier = young_world
					}
				}
				save_event_target_as = friendly_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:friendly_situation = {
			add_situation_progress = 20
		}
		event_target:friendly_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = EXPANDED_FRIENDLY_ANIMALS_CAT
			}
		}
	}
}

situation_event = {
	id = leviathanexpanded.201
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:sea_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = sea_divination_planet
			}
			any_planet_within_border = {
				is_ocean = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = sea_situation
		owner = {
			set_country_flag = sea_divination_planet
			random_planet_within_border = {
				limit = {
					is_ocean = yes
				}
				save_event_target_as = sea_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:sea_situation = {
			add_situation_progress = 20
		}
		event_target:sea_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = SEALIFE_CAT
			}
		}
	}
}

situation_event = {
	id = leviathanexpanded.202
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:flotsam_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		owner = {
			NOT = {
				has_country_flag = flotsam_divination_planet
			}
			any_planet_within_border = {
				OR = {
					is_planet_class = pc_neutron_star
					is_planet_class = pc_pulsar
					is_planet_class = pc_magnetar
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = flotsam_situation
		owner = {
			set_country_flag = flotsam_divination_planet
			random_planet_within_border = {
				limit = {
					OR = {
						is_planet_class = pc_neutron_star
						is_planet_class = pc_pulsar
						is_planet_class = pc_magnetar
					}
				}
				save_event_target_as = flotsam_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:flotsam_situation = {
			add_situation_progress = 40
		}
		event_target:flotsam_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = NEUTRONIUM_ARMOR_CAT
			}
		}
	}
}

situation_event = {
	id = leviathanexpanded.203
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:przybylski_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		owner = {
			NOT = {
				has_country_flag = przybylski_divination_planet
			}
			any_planet_within_border = {
				is_planet_class = pc_a_star
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = przybylski_situation
		owner = {
			set_country_flag = przybylski_divination_planet
			random_planet_within_border = {
				limit = {
					is_planet_class = pc_a_star
				}
				save_event_target_as = przybylski_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:przybylski_situation = {
			add_situation_progress = 40
		}
		event_target:przybylski_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = EXPANDED_PRZYBYLSKI_STAR_CAT
			}
		}
	}
}

situation_event = {
	id = leviathanexpanded.204
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:primitive_probe_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		owner = {
			NOT = {
				has_country_flag = primitive_probe_divination_planet
			}
			any_system_within_border = {
				any_neighbor_system = {
					any_system_planet = {
						OR = {
							NOT = { exists = space_owner }
							AND = {
								exists = space_owner
								space_owner = { is_same_value = from.owner }
							}
						}
						OR = {
							AND = {
								is_planet_class = pc_nuked
								NOT = { exists = owner }
							}
							AND = {
								exists = owner
								owner = {
									is_primitive = yes
									has_country_flag = early_space_age
								}
							}
						}
					}
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = primitive_probe_situation
		owner = {
			set_country_flag = primitive_probe_divination_planet
			random_system_within_border = {
				limit = {
					any_neighbor_system = {
						any_system_planet = {
							OR = {
								NOT = { exists = space_owner }
								AND = {
									exists = space_owner
									space_owner = { is_same_value = from.owner }
								}
							}
							OR = {
								AND = {
									is_planet_class = pc_nuked
									NOT = { exists = owner }
								}
								AND = {
									exists = owner
									owner = {
										is_primitive = yes
										has_country_flag = early_space_age
									}
								}
							}
						}
					}
				}
				random_system_planet = {
					limit = { uninhabitable_regular_planet = yes }
					save_event_target_as = primitive_probe_divination_planet
				}
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:primitive_probe_situation = {
			add_situation_progress = 40
		}
		event_target:primitive_probe_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = primitive_probe_anomaly
			}
		}
	}
}

situation_event = {
	id = leviathanexpanded.205
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:old_star_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 30
		owner = {
			NOT = {
				has_country_flag = old_star_divination_planet
			}
			any_planet_within_border = {
				is_planet_class = pc_m_star
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = old_star_situation
		owner = {
			set_country_flag = old_star_divination_planet
			random_planet_within_border = {
				limit = {
					is_planet_class = pc_m_star
				}
				save_event_target_as = old_star_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:old_star_situation = {
			add_situation_progress = 40
		}
		event_target:old_star_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = old_star
			}
		}
	}
}

situation_event = {
	id = leviathanexpanded.206
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:unknown_origin_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = unknown_origin_divination_planet
			}
			any_planet_within_border = {
				is_asteroid = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = unknown_origin_situation
		owner = {
			set_country_flag = unknown_origin_divination_planet
			random_planet_within_border = {
				limit = {
					is_asteroid = yes
				}
				save_event_target_as = unknown_origin_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:unknown_origin_situation = {
			add_situation_progress = 20
		}
		event_target:unknown_origin_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = origin_asteroid_category
			}
		}
	}
}

situation_event = {
	id = leviathanexpanded.207
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:emissions_asteroid_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = emissions_asteroid_divination_planet
			}
			any_planet_within_border = {
				is_asteroid = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = emissions_asteroid_situation
		owner = {
			set_country_flag = emissions_asteroid_divination_planet
			random_planet_within_border = {
				limit = {
					is_asteroid = yes
				}
				save_event_target_as = emissions_asteroid_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:emissions_asteroid_situation = {
			add_situation_progress = 20
		}
		event_target:emissions_asteroid_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = emissions_asteroid_category
			}
		}
	}
}

situation_event = {
	id = leviathanexpanded.208
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:life_frozen_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = life_frozen_divination_planet
			}
			any_planet_within_border = {
				is_frozen = yes
				has_any_strategic_resource = no
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = life_frozen_situation
		owner = {
			set_country_flag = life_frozen_divination_planet
			random_planet_within_border = {
				limit = {
					is_frozen = yes
					has_any_strategic_resource = no
				}
				save_event_target_as = life_frozen_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:life_frozen_situation = {
			add_situation_progress = 20
		}
		event_target:life_frozen_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = life_frozen_category
			}
		}
	}
}

situation_event = {
	id = leviathanexpanded.209
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:tollok_rong_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 35
		owner = {
			NOT = {
				has_country_flag = tollok_rong_divination_planet
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = tollok_rong_situation
		owner = {
			set_country_flag = tollok_rong_divination_planet
			random_planet_within_border = {
				limit = {
					is_planet_class = pc_gas_giant
				}
				save_event_target_as = tollok_rong_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:tollok_rong_situation = {
			add_situation_progress = 30
		}
		event_target:tollok_rong_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = signal_gasgiant_category
			}
		}
	}
}

situation_event = {
	id = leviathanexpanded.210
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:asteroid_waves_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		owner = {
			NOT = {
				has_country_flag = asteroid_waves_divination_planet
			}
			any_planet_within_border = {
				is_asteroid = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = asteroid_waves_situation
		owner = {
			set_country_flag = asteroid_waves_divination_planet
			random_planet_within_border = {
				limit = {
					is_asteroid = yes
				}
				save_event_target_as = asteroid_waves_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:asteroid_waves_situation = {
			add_situation_progress = 30
		}
		event_target:asteroid_waves_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = AST_WAVELENGTHS_1_CAT
			}
		}
	}
}

situation_event = {
	id = leviathanexpanded.211
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:dimensional_pocket_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		owner = {
			NOT = {
				has_country_flag = dimensional_pocketed
			}
			any_planet_within_border = {
				is_asteroid = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = dimensional_pocket_situation
		owner = {
			set_country_flag = dimensional_pocketed
			random_planet_within_border = {
				limit = {
					is_asteroid = yes
				}
				save_event_target_as = dimensional_pocket_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:dimensional_pocket_situation = {
			add_situation_progress = 30
		}
		event_target:dimensional_pocket_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = DIMENSIONAL_POCKET_CAT
			}
		}
	}
}

situation_event = {
	id = leviathanexpanded.212
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 10
		NOT = { has_global_flag = seismic_disturbance_global }
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					NOR = {
						has_planet_flag = colony_event
						is_planet_class = pc_nuked
						is_planet_class = pc_ringworld_habitable
						is_planet_class = pc_habitat
						is_planet_class = pc_city
						is_planet_class = pc_relic
					}
				}
				save_event_target_as = seismic_divination_planet
			}
			event_target:seismic_divination_planet = {
				planet_event = {
					id = colony.50
				}
			}
		}
	}
}

situation_event = {
	id = leviathanexpanded.213
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 10
		NOT = { has_country_flag = FLDrone_country }
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					NOR = {
						is_planet_class = pc_habitat
						has_planet_flag = colony_event
						has_planet_flag = FLDrone_event
					}
					has_moon = yes
					any_moon = {
						habitable_planet = no
					}
				}
				save_event_target_as = helpful_drone_divination_planet
			}
			event_target:helpful_drone_divination_planet = {
				planet_event = {
					id = colony.1500
				}
			}
		}
	}
}