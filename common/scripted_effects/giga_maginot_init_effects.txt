


init_giga_maginot = {
	init_giga_maginot_setup = yes
	spawn_giga_maginot_garrison = yes
	init_giga_maginot_defences = yes
}

init_giga_maginot_setup = {
	# clean flags
	#remove_planet_flag = has_megastructure
	#remove_planet_flag = megastructure
	remove_planet_flag = has_planet_mw_mega
	
	# set flags
	set_planet_flag = giga_maginot_world
	set_planet_flag = colony_event # avoids subterranean civilization

	# attached deposit
	add_deposit = d_maginot_command
	# remove the construction one
	remove_deposit = d_maginot_construction_blocker
	#add_modifier = { modifier = "giga_maginot_world" days = -1 }

	# "upgrade" attached building
	remove_building = building_giga_maginot_stronghold
	add_building = building_giga_maginot_global_bunker
}

spawn_giga_maginot_garrison = {
	# create some armies since they can't be from the deposit
	if = {
		limit = { exists = planet_owner planet_owner = { is_machine_empire = no } }
		while = { count = 5	create_army = { name = "Heavy Defence Unit"	owner = planet.owner species = planet.owner.species type = "heavy_defender" } }
	}
	else_if = {
		limit = { exists = planet_owner planet_owner = { is_machine_empire = yes } }
		while = { count = 5	create_army = { name = "Heavy Defence Unit"	owner = planet.owner species = planet.owner.species type = "machine_heavy_defender" } }
	}
}

init_giga_maginot_defences = {
	set_planet_flag = maginot_has_orbital_defence
	solar_system = {
		assign_giga_maginot_id = yes
	}
	init_giga_maginot_variables = yes
	# start watchdog event for the orbital fleet
	planet_event = {
		id = maginot_orbital_defence.1007
		days = 30
	}
	if = {
		limit = { ROOT.from = { has_active_tradition = tr_gigabulwark_happy_defenses } }
		add_modifier = {
			modifier = giga_bulwark_trad_stability_maginot
			days = -1
		}
	}

	maginot_create_orbital_defence_fleet = yes
}