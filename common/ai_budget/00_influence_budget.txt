# Original File
#
# Calvitix Check 3.3.1  23.02.2022
#
# Merge with STARNET AI    16.09.2021
#
#
## Categories used in this file must have use_for_ai_budget = yes defined in economic_categories ##
## It is possible to have multiple entries with the same category and resource ##

#################
## Expenditure ##
#################
influence_expenditure_buffer = { # Buffer, will not be spent
	resource = influence
	type = expenditure
	category = buffer

	potential = {
		always = no
	}

	fraction = {
		weight = 0.0
	}
}

influence_expenditure_decisions = {
	resource = influence
	type = expenditure
	category = decisions

	potential = {
		always = yes
###Starnet AI
		or = {
			not = { has_country_flag = saving_influence_arcology }
			and = {
				has_country_flag = saving_influence_arcology
				resource_stockpile_compare = {
					resource = influence
					value > 220
				}
			}
		}
###
	}

	fraction = { #3.2
		weight = 0.20
		modifier = {
			factor = 2
			OR = {
				AND = {
					has_technology = tech_housing_2
					any_owned_planet = {
						is_planet_class = pc_relic
						num_uncleared_blockers < 1
					}
				}
				AND = {
					has_ascension_perk = ap_arcology_project
					any_owned_planet = {
						is_artificial = no
						NOR = {
							is_planet_class = pc_city
							is_planet_class = pc_relic
							has_modifier = resort_colony
							has_modifier = penal_colony
							has_modifier = slave_colony
							has_modifier = pm_wenkwort_custodian
						}
						num_uncleared_blockers < 1
						free_district_slots < 1
						OR = {
							num_pops >= 70
							is_capital = yes
						}
					}
				}
			}
		}
	}
	static_min = {
		base = 300
	}
}

influence_expenditure_resolutions = {
	resource = influence
	type = expenditure
	category = resolutions

	potential = {
		is_galactic_community_member = yes
		NOT = { is_proposing_resolution = "any" }
		resource_stockpile_compare = {
			resource = influence
			value > 260
		}
	}

	fraction = {
		weight = 0.15
	}

	# min/max resolution proposal costs defined in resolutions.txt

	static_min = {
		base = 100
	}

	static_max = {
		base = 300
	}
}

influence_expenditure_edicts = {
	resource = influence
	type = expenditure
	category = edicts

	potential = {
###Starnet AI
		resource_stockpile_compare = {
			resource = influence
		value > 250
		}
###Starnet AI end
		is_death_cult_empire = yes
		NOR = {
			has_edict = sacrifice_bounty
			has_edict = sacrifice_bounty_zombie
			has_edict = sacrifice_harmony
			has_edict = sacrifice_togetherness
		}
	}

	fraction = {
		weight = 0.5 #0.25
	}

	static_min = {
		base = 500 #100 #Calvitix, has lower importance since 3.3.1
	}

	#static_max = {
	#	base = 100
	#}	
}


influence_expenditure_stations = {
	resource = influence
	type = expenditure
	category = stations

	potential = {
	or = {
		has_ai_expansion_plan = yes
		and = {
###Starnet AI
			str_is_allowed_to_build_outposts = yes
			not = { has_country_flag = saving_influence_arcology }
			nand = {
				is_allowed_to_make_claims = yes
				has_country_flag = ferocious_rusher
				any_neighbor_country = {
					is_country_type = default
					is_subject = no
					not = { has_truce = prev }
					prev = {
						opinion = {
						who = prev 
						value < -100
						}
					}
				}
				resource_stockpile_compare = {
					resource = influence
					value < 300
				}
			}
			nand = {
				not = { has_edict = capacity_subsidies }
				has_technology = tech_power_hub_1
			}
	###Starnet AI end
		}		
	}
	}

	fraction = {
		weight = 0.2 #0.5
	}

	# min is 1 jump away
	static_min = {
		base = 0 #75
###Starnet AI
		modifier = {
			add = 200
			resource_stockpile_compare = {
				resource = influence
				value > 250
			}
		}
		modifier = {
			add = 100
			years_passed < 20
		}
###Starnet AI end
	}
}

influence_expenditure_stations_save_for_edicts = {
	resource = influence 
	type = expenditure
	category = stations
	
	potential = {
		not = { has_country_flag = saving_influence_arcology }
		nand = {
			is_allowed_to_make_claims = yes
			has_country_flag = ferocious_rusher
			any_neighbor_country = {
				is_country_type = default
				is_subject = no
				not = { has_truce = prev }
				prev = {
					opinion = {
					who = prev 
					value < -100
					}
				}
			}
			resource_stockpile_compare = {
				resource = influence
				value < 300
			}
		}
		or = {
		and = {
				or = {
					has_edict = capacity_subsidies
					not = { has_technology = tech_power_hub_1 }
				}
				or = {
					has_edict = mining_subsidies not = { has_technology = tech_mineral_purification_1 } 
					not = { has_ascension_perk = ap_executive_vigor }
				}
			}
			resource_stockpile_compare = {
				resource = influence
				value > 200	
				}
		}
	}

	fraction = {
		weight = 0.2
	}
}


###Starnet AI
influence_expenditure_stations_wartime = {
	resource = influence 
	type = expenditure
	category = stations
	
	potential = {
		resource_stockpile_compare = {
			resource = influence
			value > 250
		}
		is_at_war = yes
		not = { has_country_flag = saving_influence_arcology }
	}
	
	fraction = {
		weight = 0.2
	}	
}
###Starnet AI end


influence_expenditure_claims_late = {
	resource = influence
	type = expenditure
	category = claims

	potential = {
		is_at_war = no
		is_allowed_to_make_claims = yes
		not = { has_country_flag = saving_influence_arcology }
		years_passed > @str_ai_will_not_declare_war_until
		NOT = {
			OR = {
				has_ethic = ethic_fanatic_pacifist
				has_ethic = ethic_pacifist
				has_crisis_level = crisis_level_2
			}
		}
		resource_stockpile_compare = {
			resource = influence
			value > 250
		}
	}

	fraction = {
		weight = 0.75
	}
	static_min = {
		base = 500
	}
}

influence_expenditure_claims_while_preparing = {
	resource = influence
	type = expenditure
	category = claims

	potential = {
		years_passed > @str_ai_will_not_declare_war_until
		is_allowed_to_make_claims = yes
		not = { has_country_flag = saving_influence_arcology }
		or = {
			and = {
		prepare_for_war = yes
		used_naval_capacity_percent > 0.7
	}
		is_at_war = yes
	}
	NOT = {
			   has_ethic = ethic_fanatic_pacifist
	}
	}
	
	fraction = {
		weight = 0.4
	}
	static_min = {
		base = 400
	}
}
### Starnet AI end


influence_expenditure_claims_fanatic_militarist = {
	resource = influence
	type = expenditure
	category = claims

	potential = {
		has_ethic = ethic_fanatic_militarist
		has_potential_claims = yes
	}

	fraction = {
		weight = 0.10
	}
}

influence_expenditure_megastructures = {
	resource = influence
	type = expenditure
	category = megastructures

	potential = {
		is_at_war = no
		OR = {
			has_technology = tech_gateway_construction
			has_technology = tech_ring_world
		}

		has_resource = {
			type = influence
			amount > 500
		}
	}

	fraction = {
		weight = 0.1
	}

	# only used by construction sites, base cost is 300
	static_min = {
		base = 75
		modifier = {
			add = 225
			has_technology = tech_ring_world
			NOT = {
				any_owned_planet = { is_planet_class = pc_ringworld_habitable }
			}
		}
	}
	static_max = {
		base = 75
		modifier = {
			add = 225
			has_technology = tech_ring_world
		}
	}
}

influence_expenditure_habitats = {
	resource = influence
	type = expenditure
	category = megastructures_habitat

	potential = { ai_should_build_habitats = yes }

	fraction = {
		weight = 0.1
		modifier = {
			factor = 2
			has_origin = origin_void_dwellers
		}
		modifier = {
			factor = 2
			has_origin = origin_void_dwellers
			count_owned_planet = {
				limit = { is_planet_class = pc_habitat }
				count < 4
			}
		}
		modifier = {
			factor = 2
			has_origin = origin_void_dwellers
			count_owned_planet = {
				limit = { is_planet_class = pc_habitat }
				count < 6
			}
		}
	}

	static_min = {
		base = 150
	}
	static_max = {
		base = 350 #150
	}
}
