giga_amb_stockpile_calc = {
	base = 0

	weight = giga_amb_income
	multiply = 2

	complex_trigger_modifier = {
		trigger = resource_stockpile_compare
		parameters = {
			resource = giga_sr_amb_megaconstruction
		}
		mode = max
	}

	min = 0
}

giga_amb_total_progress_calc = {
	base = 0

	add = giga_amb_stockpile
	mult = @giga_amb_ratio # speed per income

	min = 0.01
}

giga_amb_building_megas_calc = {
	base = 0

	complex_trigger_modifier = {
		trigger = count_owned_megastructure
		parameters = {
			limit = {
				is_upgrading = yes
			}
		}
		mode = weight
	}

	complex_trigger_modifier = {
		trigger = count_owned_fleet
		parameters = {
			limit = {
				any_owned_ship = {
					is_constructing = megastructure
				}
			}
		}
		mode = add
	}
}

giga_amb_building_megas_calc_min = {
	weight = giga_amb_building_megas
	min = 1
}

giga_amb_progress_calc = {
	base = 0
	weight = giga_amb_total_progress

	divide = value:giga_amb_building_megas_calc_min
}

giga_amb_cap_calc = {
	base = 0
	complex_trigger_modifier = {
		trigger = check_variable
		parameters = {
			which = giga_amb_cap
		}
		mode = add
	}
}

giga_amb_start_bonus = {
	base = 1
	subtract = value:giga_amb_midgame_fraction
	multiply = 20

	min = 1

	round = yes
}
giga_amb_midgame_fraction = {
	base = 0
	weight = trigger:years_passed
	divide = value:giga_amb_midgame_period
}
giga_amb_midgame_period = {
	base = 0
	weight = trigger:years_passed
	subtract = trigger:mid_game_years_passed
}

giga_amb_supertensiles_target = {
	base = 0
	weight = giga_amb_cap
	multiply = 20
}

giga_amb_ai_limit_calc = {
	base = 0
	weight = giga_amb_total_progress
	divide = 0.75

	floor = yes
	min = 1
}