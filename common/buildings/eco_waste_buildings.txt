# Ecology Mod File
#
# Calvitix Check 3.1.1  18/09/2021
#
# Last update 26/09/2021
#
#
eco_building_waste_recovery = {
	base_cap_amount = 4 #calvitix
	base_buildtime = @b1_time
	can_be_ruined = no
	position_priority = 150

	category = amenity
	
	potential = {
		exists = owner
		or = {
			owner = {
				is_ai = no
			}
			and = {
				owner = {
					is_ai = yes
				}
				or = { 
					has_modifier = eco_moderate	
					has_modifier = eco_heavy
					has_modifier = eco_extreme
					has_modifier = eco_catastrophic
				}
			}
		}
	}
	
#starnet AI
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_ai = yes
			    str_raw_ecocrisis_level_0 = no
			}
			num_buildings = {
				type = eco_building_waste_recovery
				value < 2 #calvitix change
			}
			or = { 
				has_modifier = eco_heavy
				has_modifier = eco_extreme
				has_modifier = eco_catastrophic
			}			
		}
		modifier = {
			job_starnet_spice_melange_farmer_add = 1
			job_starnet_spice_melange_antifarmer_add = -1
		}
	}
###
	
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		modifier = {
			job_waste_drone_add = 2
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		modifier = {
			job_waste_drone_add = 2
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_waste_handler_add = 2
		}
	}
	
	resources = {
		category = planet_buildings
#Calvitix ressource balance
		cost = { 
			trigger = {
				from = {
					is_ai = no
				}
			}
		alloys = 10 minerals = 400}
		cost = {
			trigger = {
				from = {
					is_ai = yes
				}
			}
			minerals = 400
		}
		upkeep = {
			energy = @b1_upkeep
		}
	}
	
	upgrades = {
		eco_building_industrial_symbiosis
	}
	
	prerequisites = {
		eco_tech_waste_processing_0
	}
	
	triggered_desc = {
		trigger = { 
			exists = owner
			owner = { is_regular_empire = yes } 
		}
		text = eco_building_waste_effect
	}
	
	triggered_desc = {
		trigger = { 
			exists = owner
			owner = { is_hive_empire = yes } 
		}
		text = eco_building_waste_gestalt_effect
	}
	
	triggered_desc = {
		trigger = { 
			exists = owner
			owner = { is_machine_empire = yes } 
		}
		text = eco_building_waste_gestalt_effect
	}
	
	on_built = {
		set_planet_flag = eco_built_waste_building
	}

	on_destroy = {
		remove_planet_flag = eco_built_waste_building
	}
	
	ai_resource_production = {
		energy = 3
		trigger = {
			always = yes
		}
	}
	
}

eco_building_industrial_symbiosis = {
	base_buildtime = 480
	can_build = no

	category = amenity
	
	allow = {
		has_upgraded_capital = yes
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		modifier = {
			job_waste_drone_add = 4
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		modifier = {
			job_waste_drone_add = 4
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_waste_handler_add = 4
		}
	}
	
	resources = {
		category = planet_buildings
#Calvitix ressource balance
		cost = { 
			trigger = {
				from = {
					is_ai = no
				}
			}
		alloys = 20 
		minerals = 600
		volatile_motes = @b2_rare_cost
		}
		cost = {
			trigger = {
				from = {
					is_ai = yes
				}
			}
			minerals = 600
			volatile_motes = @b2_rare_cost
		}
		upkeep = {
			energy = @b2_upkeep
			volatile_motes = @b2_rare_upkeep
		}
	}
	
	upgrades = {
		eco_building_industrial_metabolism
	}

	prerequisites = {
		eco_tech_waste_processing_1
	}
	
	triggered_desc = {
		trigger = { 
			exists = owner
			owner = { is_regular_empire = yes } 
		}
		text = eco_building_waste_effect
	}
	
	triggered_desc = {
		trigger = { 
			exists = owner
			owner = { is_hive_empire = yes } 
		}
		text = eco_building_waste_gestalt_effect
	}
	
	triggered_desc = {
		trigger = { 
			exists = owner
			owner = { is_machine_empire = yes } 
		}
		text = eco_building_waste_gestalt_effect
	}
	
	
	on_built = {
		set_planet_flag = eco_built_waste_building
	}

	on_destroy = {
		remove_planet_flag = eco_built_waste_building
	}
	
	ai_resource_production = {
		energy = 3
		trigger = {
			always = yes
		}
	}
	
}

eco_building_industrial_metabolism = {
	base_buildtime = @b3_time
	can_build = no

	category = amenity
	
	allow = {
		has_major_upgraded_capital = yes
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		modifier = {
			job_waste_drone_add = 6
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		modifier = {
			job_waste_drone_add = 6
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_waste_handler_add = 6
		}
	}
	
	resources = {
		category = planet_buildings
#Calvitix ressource balance
		cost = { 
			trigger = {
				from = {
					is_ai = no
				}
			}
		alloys = 40 
		minerals = 800
		rare_crystals = @b2_rare_cost
		}
		cost = {
			trigger = {
				from = {
					is_ai = yes
				}
			}
			minerals = 800
			rare_crystals = @b2_rare_cost
		}
		upkeep = {
			energy = 6
			volatile_motes = @b2_rare_upkeep
			rare_crystals = @b2_rare_upkeep
		}
	}
	
	upgrades = {
		eco_building_zero_waste
	}

	prerequisites = {
		eco_tech_waste_processing_2
	}	
	
	triggered_desc = {
		trigger = { 
			exists = owner
			owner = { is_regular_empire = yes } 
		}
		text = eco_building_waste_effect
	}
	
	triggered_desc = {
		trigger = { 
			exists = owner
			owner = { is_hive_empire = yes } 
		}
		text = eco_building_waste_gestalt_effect
	}
	
	triggered_desc = {
		trigger = { 
			exists = owner
			owner = { is_machine_empire = yes } 
		}
		text = eco_building_waste_gestalt_effect
	}
	
	ai_resource_production = {
		energy = 3
		trigger = {
			always = yes
		}
	}
	
	on_built = {
		set_planet_flag = eco_built_waste_building
	}

	on_destroy = {
		remove_planet_flag = eco_built_waste_building
	}
}

eco_building_zero_waste = {
	base_buildtime = 600
	can_build = no

	category = amenity
	
	allow = {
		has_fully_upgraded_capital = yes
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		modifier = {
			job_waste_overseer_add = 1
			job_waste_drone_add = 7
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		modifier = {
			job_waste_overseer_add = 1
			job_waste_drone_add = 7
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_waste_manager_add = 1
			job_waste_handler_add = 7
		}
	}
	
	resources = {
		category = planet_buildings
#Calvitix ressource balance
		cost = { 
			trigger = {
				from = {
					is_ai = no
				}
			}
			alloys = 80 
			minerals = 1000 
			exotic_gases = @b2_rare_cost
		}
		cost = {
			trigger = {
				from = {
					is_ai = yes
				}
			}
			minerals = 1000
			sr_dark_matter = 100
		}
		upkeep = {
			energy = 8
			rare_crystals = @b2_rare_upkeep
			volatile_motes = @b2_rare_upkeep
			exotic_gases = @b2_rare_upkeep		
		}
	}

	prerequisites = {
		eco_tech_waste_processing_3
	}	
	
	triggered_desc = {
		trigger = { 
			exists = owner
			owner = { is_regular_empire = yes } 
		}
		text = eco_building_waste_2_effect
	}
	
	triggered_desc = {
		trigger = { 
			exists = owner
			owner = { is_hive_empire = yes } 
		}
		text = eco_building_waste_2_gestalt_effect
	}
	
	triggered_desc = {
		trigger = { 
			exists = owner
			owner = { is_machine_empire = yes } 
		}
		text = eco_building_waste_2_gestalt_effect
	}
	
	ai_weight = {
		weight = 0.5
		modifier = {
			factor = 1
			has_modifier = eco_minimal
		}
		modifier = {
			factor = 2
			has_modifier = eco_moderate
		}
		modifier = {
			factor = 3
			has_modifier = eco_heavy
		}
		modifier = {
			factor = 4
			has_modifier = eco_extreme
		}
		modifier = {
			factor = 5
			has_modifier = eco_catastrophic
		}
	}
}

#merged in D:\Documents\Paradox Interactive\Stellaris\mod\Calmodpack\common\buildings\12_event_buildings.txt
# building_waste_reprocessing_center = {
	# icon = building_bio_reprocessing_facilities
	# base_buildtime = 480
	# base_cap_amount = 1
	# can_build = yes
	# can_demolish = yes
	
	# potential = {
		# owner = { has_country_flag = bought_waste_reprocessing_center }
	# }

	# planet_modifier = {
		# planet_amenities_add = 5
	# }
	
	# triggered_planet_modifier = {
		# potential = {
			# exists = owner
			# owner = { is_hive_empire = yes }
		# }
		# modifier = {
			# job_waste_overseer_add = 1
		# }
	# }
	
	# triggered_planet_modifier = {
		# potential = {
			# exists = owner
			# owner = { is_machine_empire = yes }
		# }
		# modifier = {
			# job_waste_overseer_add = 1
		# }
	# }
	
	# triggered_planet_modifier = {
		# potential = {
			# exists = owner
			# owner = { is_regular_empire = yes }
		# }
		# modifier = {
			# job_waste_manager_add = 1
		# }
	# }

	# resources = {
		# category = planet_buildings
		# cost = {
			# minerals = 200 #100
		# }
		# produces = {
			# minerals = 10
			# energy = 10
		# }	
	# }
		
	# triggered_desc = {
		# trigger = { 
			# exists = owner
			# owner = { is_regular_empire = yes } 
		# }
		# text = job_waste_manager_effect_desc
	# }
	
	# triggered_desc = {
		# trigger = { 
			# exists = owner
			# owner = { is_hive_empire = yes } 
		# }
		# text = job_waste_overseer_effect_desc
	# }
	
	# triggered_desc = {
		# trigger = { 
			# exists = owner
			# owner = { is_machine_empire = yes } 
		# }
		# text = job_waste_overseer_effect_desc
	# }
# }

# eco_building_junkyard = {
	# base_buildtime = 360
	# can_build = yes
	# can_demolish = yes
	# base_cap_amount = 1
	# category = amenity
	
	# potential = {
		# NOT = { is_planet_class = pc_machine }
# #Calvitix ressource balance
		# OR = {
				# owner = { is_ai = no }
				# AND = { 
					# NOT = { has_modifier = eco_minimal }
					# NOT = { has_modifier = eco_clean }
					# NOT = { has_modifier = eco_pristine	}
				# }
		# }		
	# }
	
	# triggered_planet_modifier = {
		# potential = {
			# exists = owner
			# OR = { 
				# owner = { is_hive_empire = yes }
				# owner = { is_machine_empire = yes }
			# }
		# }
		# modifier = {
			# job_waste_drone_add = 2
		# }
	# }
	
	# triggered_planet_modifier = {
		# potential = {
			# exists = owner
			# OR = { 
				# owner = { is_hive_empire = yes }
				# owner = { is_machine_empire = yes }
			# }
			# owner = { has_technology = eco_tech_waste_recycling }
		# }
		# modifier = {
			# job_waste_drone_add = 1
		# }
	# }
	
	# triggered_planet_modifier = {
		# potential = {
			# exists = owner
			# OR = { 
				# owner = { is_hive_empire = yes }
				# owner = { is_machine_empire = yes }
			# }
			# owner = { has_technology = eco_tech_waste_recycling_2 }
		# }
		# modifier = {
			# job_waste_drone_add = 1
		# }
	# }
	
	# triggered_planet_modifier = {
		# potential = {
			# exists = owner
			# owner = { is_regular_empire = yes }
		# }
		# modifier = {
			# job_waste_handler_add = 2
		# }
	# }
	
	# triggered_planet_modifier = {
		# potential = {
			# exists = owner
			# owner = { is_regular_empire = yes }
			# owner = { has_technology = eco_tech_waste_recycling }
		# }
		# modifier = {
			# job_waste_handler_add = 1
		# }
	# }
	
	# triggered_planet_modifier = {
		# potential = {
			# exists = owner
			# owner = { is_regular_empire = yes }
			# owner = { has_technology = eco_tech_waste_recycling_2 }
		# }
		# modifier = {
			# job_waste_handler_add = 1
		# }
	# }
	
	# resources = {
		# category = planet_buildings
		# cost = {
			# minerals = 300 #200
		# }
		# upkeep = {
			# energy = 1
		# }
	# }
	
	# triggered_desc = {
		# trigger = { 
			# exists = owner
			# owner = { is_regular_empire = yes } 
		# }
		# text = job_waste_handler_effect_desc
	# }
	
	# triggered_desc = {
		# trigger = { 
			# exists = owner
			# owner = { is_hive_empire = yes } 
		# }
		# text = job_waste_drone_effect_desc
	# }

# #Calvitix ressource balance
	# destroy_trigger = {
		# free_building_slots = 0
		# or = {
			# has_modifier = eco_pristine
			# has_modifier = eco_clean		
		# }
		# #supervised_destruction = yes
		# not = {
				# has_planet_flag = just_destroyed_building
		# }
	# }

	# on_destroy = {
		# set_timed_planet_flag = {
			# flag = just_destroyed_building
			# days = 36
		# }
	# }
	
# }